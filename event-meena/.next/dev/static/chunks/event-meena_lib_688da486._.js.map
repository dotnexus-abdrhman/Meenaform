{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/client.ts"],"sourcesContent":["/**\n * API Client - Axios مع التكوين الأساسي\n * يتضمن interceptors للـ Token و Error handling\n */\n\nimport axios, { AxiosError, AxiosInstance, InternalAxiosRequestConfig } from \"axios\";\n\n// عنوان الـ Backend API\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:5250/api\";\n\n// مفاتيح LocalStorage\nconst ACCESS_TOKEN_KEY = \"event_meena_access_token\";\nconst REFRESH_TOKEN_KEY = \"event_meena_refresh_token\";\n\n/**\n * استجابة الـ API الموحدة من Backend\n */\nexport interface ApiResponse<T> {\n  success: boolean;\n  data: T | null;\n  message: string | null;\n  errors: string[] | null;\n}\n\n/**\n * صيغة Problem Details من ASP.NET Core (FluentValidation)\n */\ninterface ProblemDetails {\n  type?: string;\n  title?: string;\n  status?: number;\n  errors?: Record<string, string[]>;\n  traceId?: string;\n}\n\n/**\n * خطأ API مخصص\n */\nexport class ApiError extends Error {\n  status: number;\n  errors: string[];\n\n  constructor(message: string, status: number, errors: string[] = []) {\n    super(message);\n    this.name = \"ApiError\";\n    this.status = status;\n    this.errors = errors;\n  }\n}\n\n/**\n * إدارة التوكنات\n */\nexport const tokenManager = {\n  getAccessToken: (): string | null => {\n    if (typeof window === \"undefined\") return null;\n    return localStorage.getItem(ACCESS_TOKEN_KEY);\n  },\n\n  getRefreshToken: (): string | null => {\n    if (typeof window === \"undefined\") return null;\n    return localStorage.getItem(REFRESH_TOKEN_KEY);\n  },\n\n  setTokens: (accessToken: string, refreshToken: string): void => {\n    if (typeof window === \"undefined\") return;\n    localStorage.setItem(ACCESS_TOKEN_KEY, accessToken);\n    localStorage.setItem(REFRESH_TOKEN_KEY, refreshToken);\n  },\n\n  clearTokens: (): void => {\n    if (typeof window === \"undefined\") return;\n    localStorage.removeItem(ACCESS_TOKEN_KEY);\n    localStorage.removeItem(REFRESH_TOKEN_KEY);\n  },\n\n  hasValidToken: (): boolean => {\n    return !!tokenManager.getAccessToken();\n  },\n};\n\n/**\n * إنشاء Axios Instance\n */\nconst createApiClient = (): AxiosInstance => {\n  const client = axios.create({\n    baseURL: API_BASE_URL,\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    timeout: 30000, // 30 ثانية\n  });\n\n  // Request Interceptor - إضافة التوكن لكل طلب\n  client.interceptors.request.use(\n    (config: InternalAxiosRequestConfig) => {\n      const token = tokenManager.getAccessToken();\n      if (token && config.headers) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n      return config;\n    },\n    (error) => Promise.reject(error)\n  );\n\n  // Response Interceptor - معالجة الأخطاء وتجديد التوكن\n  client.interceptors.response.use(\n    (response) => response,\n    async (error: AxiosError<ApiResponse<unknown>>) => {\n      const originalRequest = error.config as InternalAxiosRequestConfig & {\n        _retry?: boolean;\n      };\n\n      // إذا كان الخطأ 401 ولم نحاول التجديد بعد\n      if (error.response?.status === 401 && !originalRequest._retry) {\n        originalRequest._retry = true;\n\n        const refreshToken = tokenManager.getRefreshToken();\n        if (refreshToken) {\n          try {\n            // محاولة تجديد التوكن\n            const response = await axios.post<ApiResponse<{\n              accessToken: string;\n              refreshToken: string;\n            }>>(`${API_BASE_URL}/Auth/refresh-token`, {\n              refreshToken,\n            });\n\n            if (response.data.success && response.data.data) {\n              const { accessToken, refreshToken: newRefreshToken } = response.data.data;\n              tokenManager.setTokens(accessToken, newRefreshToken);\n\n              // إعادة المحاولة مع التوكن الجديد\n              if (originalRequest.headers) {\n                originalRequest.headers.Authorization = `Bearer ${accessToken}`;\n              }\n              return client(originalRequest);\n            }\n          } catch {\n            // فشل تجديد التوكن - تسجيل الخروج\n            tokenManager.clearTokens();\n            if (typeof window !== \"undefined\") {\n              window.location.href = \"/login\";\n            }\n          }\n        }\n      }\n\n      // تحويل الخطأ إلى ApiError\n      const apiError = createApiError(error);\n      return Promise.reject(apiError);\n    }\n  );\n\n  return client;\n};\n\n/**\n * التحقق من أن الـ response هو Problem Details\n */\nconst isProblemDetails = (data: unknown): data is ProblemDetails => {\n  return (\n    typeof data === \"object\" &&\n    data !== null &&\n    \"title\" in data &&\n    \"status\" in data\n  );\n};\n\n/**\n * استخراج رسائل الخطأ من Problem Details\n */\nconst extractProblemDetailsErrors = (problemDetails: ProblemDetails): string[] => {\n  const errors: string[] = [];\n\n  if (problemDetails.errors) {\n    // تحويل object { \"Password\": [\"error1\", \"error2\"] } إلى array\n    Object.values(problemDetails.errors).forEach((fieldErrors) => {\n      if (Array.isArray(fieldErrors)) {\n        errors.push(...fieldErrors);\n      }\n    });\n  }\n\n  return errors;\n};\n\n/**\n * إنشاء ApiError من AxiosError\n */\nconst createApiError = (error: AxiosError<ApiResponse<unknown> | ProblemDetails>): ApiError => {\n  if (error.response) {\n    const { data, status } = error.response;\n\n    // التحقق من Problem Details format (من FluentValidation)\n    if (isProblemDetails(data)) {\n      const errors = extractProblemDetailsErrors(data);\n      const message = errors.length > 0\n        ? errors.join(\" | \")\n        : data.title || getErrorMessage(status);\n      return new ApiError(message, status, errors);\n    }\n\n    // التعامل مع ApiResponse format العادي\n    const apiData = data as ApiResponse<unknown>;\n    const message = apiData?.message || getErrorMessage(status);\n    const errors = apiData?.errors || [];\n    return new ApiError(message, status, errors);\n  }\n\n  if (error.request) {\n    return new ApiError(\"لا يمكن الاتصال بالخادم. تأكد من اتصالك بالإنترنت.\", 0, []);\n  }\n\n  return new ApiError(error.message || \"حدث خطأ غير متوقع\", 0, []);\n};\n\n/**\n * الحصول على رسالة خطأ بناءً على الكود\n */\nconst getErrorMessage = (status: number): string => {\n  switch (status) {\n    case 400:\n      return \"طلب غير صالح. تحقق من البيانات المدخلة.\";\n    case 401:\n      return \"غير مصرح. يرجى تسجيل الدخول مرة أخرى.\";\n    case 403:\n      return \"غير مسموح. ليس لديك صلاحية للوصول.\";\n    case 404:\n      return \"غير موجود. المورد المطلوب غير متاح.\";\n    case 409:\n      return \"تعارض. البيانات موجودة مسبقاً.\";\n    case 422:\n      return \"بيانات غير صالحة. تحقق من المدخلات.\";\n    case 429:\n      return \"طلبات كثيرة. انتظر قليلاً ثم حاول مرة أخرى.\";\n    case 500:\n      return \"خطأ في الخادم. حاول مرة أخرى لاحقاً.\";\n    case 502:\n    case 503:\n    case 504:\n      return \"الخدمة غير متاحة حالياً. حاول مرة أخرى لاحقاً.\";\n    default:\n      return \"حدث خطأ غير متوقع.\";\n  }\n};\n\n// إنشاء وتصدير الـ API Client\nexport const apiClient = createApiClient();\n\n// تصدير افتراضي\nexport default apiClient;\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 203, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/mappers.ts"],"sourcesContent":["/**\n * Data Mappers - تحويل البيانات بين Frontend و Backend\n * \n * Backend يستخدم PascalCase:\n *   - FullName, ProfileImage, AccessToken\n *   - Guid IDs\n * \n * Frontend يستخدم camelCase:\n *   - name, avatar, token\n *   - string IDs\n */\n\nimport { User } from \"@/types/auth\";\nimport { Contact, ContactFormData, Group, GroupFormData } from \"@/types/contact\";\nimport { Event, EventFormData, EventStatus, EventType, EventSettings, EventStats } from \"@/types/event\";\n\n// ============================================================\n// أنواع Backend DTOs (ما يأتي من الـ API)\n// ============================================================\n\n/** استجابة المصادقة من Backend */\nexport interface BackendAuthResponse {\n  userId: string;\n  fullName: string;\n  email: string;\n  profileImage: string | null;\n  accessToken: string;\n  refreshToken: string;\n  expiresAt: string;\n}\n\n/** بيانات المستخدم من Backend */\nexport interface BackendUserDto {\n  id: string;\n  fullName: string;\n  email: string;\n  phone: string | null;\n  profileImage: string | null;\n  isActive: boolean;\n  lastLoginAt: string | null;\n  createdAt: string;\n}\n\n/** الاستجابة المُرقّمة من Backend */\nexport interface BackendPagedResult<T> {\n  items: T[];\n  totalCount: number;\n  pageNumber: number;\n  pageSize: number;\n  totalPages: number;\n  hasPreviousPage: boolean;\n  hasNextPage: boolean;\n}\n\n/** عنصر قائمة الحدث من Backend (للقوائم) */\nexport interface BackendEventListItemDto {\n  id: string;\n  title: string;\n  description: string | null;\n  type: number;\n  status: number;\n  coverImage: string | null;\n  shareCode: string;\n  viewCount: number;\n  responseCount: number;\n  completedResponseCount: number;\n  sectionsCount: number;\n  componentsCount: number;\n  completionRate: number;\n  createdAt: string;\n}\n\n/** جهة الاتصال من Backend */\nexport interface BackendContactDto {\n  id: string;\n  name: string;\n  email: string | null;\n  phone: string | null;\n  company: string | null;\n  jobTitle: string | null;\n  notes: string | null;\n  tags: string[];\n  groupIds: string[];\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string | null;\n  stats: {\n    eventsSent: number;\n    eventsCompleted: number;\n    responseRate: number;\n    lastInteraction: string | null;\n  } | null;\n}\n\n/** المجموعة من Backend */\nexport interface BackendGroupDto {\n  id: string;\n  name: string;\n  description: string | null;\n  color: string | null;\n  icon: string | null;\n  isActive: boolean;\n  contactCount: number;\n  contactIds: string[];\n  createdAt: string;\n  updatedAt: string | null;\n  stats: {\n    eventsSent: number;\n    averageResponseRate: number;\n    lastEventSent: string | null;\n  } | null;\n}\n\n/** الحدث من Backend */\nexport interface BackendEventDto {\n  id: string;\n  title: string;\n  description: string | null;\n  type: number; // Enum as number\n  status: number; // Enum as number\n  coverImage: string | null;\n  themeColor: string | null;\n  language: string | null;\n  startDate: string | null;\n  endDate: string | null;\n  timeLimitMinutes: number | null;\n  shareCode: string;\n  shareLink: string | null;\n  requireLogin: boolean;\n  allowAnonymous: boolean;\n  maxResponses: number | null;\n  allowMultipleResponses: boolean;\n  allowEditResponses: boolean;\n  showResults: boolean;\n  showCorrectAnswers: boolean;\n  shuffleQuestions: boolean;\n  shuffleOptions: boolean;\n  passingScore: number | null;\n  thankYouMessage: string | null;\n  successMessage: string | null;\n  goodMessage: string | null;\n  improvementMessage: string | null;\n  viewCount: number;\n  responseCount: number;\n  createdAt: string;\n  updatedAt: string | null;\n}\n\n/** المكون من Backend */\nexport interface BackendComponentDto {\n  id: string;\n  type: number; // ComponentType enum\n  order: number;\n  title: string | null;\n  description: string | null;\n  placeholder: string | null;\n  isRequired: boolean;\n  isVisible: boolean;\n  optionsJson: string | null;\n  validationJson: string | null;\n  correctAnswerJson: string | null;\n  points: number | null;\n  explanation: string | null;\n  minValue: number | null;\n  maxValue: number | null;\n  minLabel: string | null;\n  maxLabel: string | null;\n  mediaUrl: string | null;\n  mediaType: string | null;\n  styleJson: string | null;\n  sectionId: string;\n  createdAt: string;\n  updatedAt: string | null;\n}\n\n/** القسم مع المكونات من Backend */\nexport interface BackendSectionWithComponentsDto {\n  id: string;\n  title: string;\n  description: string | null;\n  order: number;\n  isVisible: boolean;\n  eventId: string;\n  createdAt: string;\n  components: BackendComponentDto[];\n}\n\n/** الحدث مع التفاصيل الكاملة من Backend */\nexport interface BackendEventWithFullDetailsDto extends BackendEventDto {\n  sections: BackendSectionWithComponentsDto[];\n}\n\n// ============================================================\n// Mappers: Backend → Frontend\n// ============================================================\n\n/**\n * تحويل استجابة المصادقة\n */\nexport const mapAuthResponse = (backend: BackendAuthResponse): {\n  user: User;\n  token: string;\n  refreshToken: string;\n} => ({\n  user: {\n    id: backend.userId,\n    name: backend.fullName,\n    email: backend.email,\n    phone: \"\", // سيتم جلبه لاحقاً من /me\n    avatar: backend.profileImage || undefined,\n    createdAt: new Date().toISOString(),\n  },\n  token: backend.accessToken,\n  refreshToken: backend.refreshToken,\n});\n\n/**\n * تحويل بيانات المستخدم\n */\nexport const mapUser = (backend: BackendUserDto): User => ({\n  id: backend.id,\n  name: backend.fullName,\n  email: backend.email,\n  phone: backend.phone || \"\",\n  avatar: backend.profileImage || undefined,\n  createdAt: backend.createdAt,\n});\n\n/**\n * تحويل جهة الاتصال\n */\nexport const mapContact = (backend: BackendContactDto): Contact => ({\n  id: backend.id,\n  userId: \"\", // سيتم ملؤه من السياق\n  name: backend.name,\n  email: backend.email || \"\",\n  phone: backend.phone || \"\",\n  company: backend.company || undefined,\n  jobTitle: backend.jobTitle || undefined,\n  notes: backend.notes || undefined,\n  tags: backend.tags || [],\n  groupIds: backend.groupIds || [],\n  stats: backend.stats ? {\n    eventsSent: backend.stats.eventsSent,\n    eventsCompleted: backend.stats.eventsCompleted,\n    responseRate: backend.stats.responseRate,\n    lastInteraction: backend.stats.lastInteraction || undefined,\n  } : {\n    eventsSent: 0,\n    eventsCompleted: 0,\n    responseRate: 0,\n  },\n  createdAt: backend.createdAt,\n  updatedAt: backend.updatedAt || backend.createdAt,\n});\n\n/**\n * تحويل المجموعة\n */\nexport const mapGroup = (backend: BackendGroupDto): Group => ({\n  id: backend.id,\n  userId: \"\", // سيتم ملؤه من السياق\n  name: backend.name,\n  description: backend.description || undefined,\n  color: backend.color || \"#1a56db\",\n  icon: backend.icon || undefined,\n  contactIds: backend.contactIds || [],\n  membersCount: backend.contactCount,\n  stats: backend.stats ? {\n    eventsSent: backend.stats.eventsSent,\n    averageResponseRate: backend.stats.averageResponseRate,\n    lastEventSent: backend.stats.lastEventSent || undefined,\n  } : {\n    eventsSent: 0,\n    averageResponseRate: 0,\n  },\n  createdAt: backend.createdAt,\n  updatedAt: backend.updatedAt || backend.createdAt,\n});\n\n/**\n * تحويل نوع الحدث من رقم إلى نص\n * Backend Enum: Survey=1, Quiz=2, Form=3, Event=4\n * Frontend Type: \"survey\" | \"poll\" | \"form\" | \"quiz\"\n */\nconst mapEventType = (type: number): EventType => {\n  const types: Record<number, EventType> = {\n    1: \"survey\",  // Survey = 1\n    2: \"quiz\",    // Quiz = 2\n    3: \"form\",    // Form = 3\n    4: \"poll\",    // Event = 4 (نعتبره poll في الـ Frontend)\n  };\n  return types[type] || \"survey\";\n};\n\n/**\n * تحويل حالة الحدث من رقم إلى نص\n * Backend Enum: Draft=1, Published=2, Closed=3, Archived=4\n * Frontend Status: \"draft\" | \"active\" | \"archived\"\n */\nconst mapEventStatus = (status: number): EventStatus => {\n  const statuses: Record<number, EventStatus> = {\n    1: \"draft\",     // Draft = 1\n    2: \"active\",    // Published = 2 (active في الـ Frontend)\n    3: \"archived\",  // Closed = 3 (نعتبره archived)\n    4: \"archived\",  // Archived = 4\n  };\n  return statuses[status] || \"draft\";\n};\n\n/**\n * تحويل الحدث\n */\nexport const mapEvent = (backend: BackendEventDto): Event => ({\n  id: backend.id,\n  userId: \"\", // سيتم ملؤه من السياق\n  title: backend.title,\n  description: backend.description || \"\",\n  type: mapEventType(backend.type),\n  status: mapEventStatus(backend.status),\n  coverImage: backend.coverImage || undefined,\n  shareCode: backend.shareCode || undefined,\n  shareLink: backend.shareLink || `${typeof window !== \"undefined\" ? window.location.origin : \"\"}/e/${backend.shareCode}`,\n  sections: [], // سيتم جلبها بشكل منفصل\n  settings: {\n    sharingMethod: \"public_link\",\n    publicLink: backend.shareLink || undefined,\n    startDate: backend.startDate || undefined,\n    endDate: backend.endDate || undefined,\n    allowMultipleResponses: backend.allowMultipleResponses,\n    allowEdit: backend.allowEditResponses,\n    requireAuth: backend.requireLogin,\n    requireLogin: backend.requireLogin,\n    showResults: backend.showResults,\n    showProgressBar: true,\n    showCorrectAnswers: backend.showCorrectAnswers,\n    shuffleQuestions: backend.shuffleQuestions,\n    allowAnonymous: backend.allowAnonymous,\n    timeLimit: backend.timeLimitMinutes || undefined,\n    passingScore: backend.passingScore || undefined,\n    thankYouMessage: backend.thankYouMessage || undefined,\n    successMessage: backend.successMessage || undefined,\n    goodMessage: backend.goodMessage || undefined,\n    improvementMessage: backend.improvementMessage || undefined,\n  },\n  stats: {\n    totalResponses: backend.responseCount,\n    completedResponses: backend.responseCount,\n    inProgressResponses: 0,\n    completionRate: backend.responseCount > 0 ? 100 : 0,\n    averageTime: 0,\n    views: backend.viewCount,\n  },\n  createdAt: backend.createdAt,\n  updatedAt: backend.updatedAt || backend.createdAt,\n  publishedAt: backend.status === 2 ? backend.createdAt : undefined, // 2 = Published\n  startDate: backend.startDate || undefined,\n  endDate: backend.endDate || undefined,\n});\n\n/**\n * تحويل عنصر قائمة الحدث من Backend إلى Frontend\n */\nexport const mapEventListItem = (backend: BackendEventListItemDto): Event => ({\n  id: backend.id,\n  title: backend.title,\n  description: backend.description || \"\",\n  type: mapEventType(backend.type),\n  status: mapEventStatus(backend.status),\n  shareCode: backend.shareCode,\n  shareLink: `${typeof window !== \"undefined\" ? window.location.origin : \"\"}/e/${backend.shareCode}`,\n  sections: [],\n  sectionsCount: backend.sectionsCount,\n  componentsCount: backend.componentsCount,\n  settings: {\n    requireAuth: false,\n    allowAnonymous: true,\n    allowMultipleResponses: false,\n    showProgressBar: true,\n    shuffleQuestions: false,\n  },\n  stats: {\n    totalResponses: backend.responseCount,\n    completedResponses: backend.completedResponseCount,\n    inProgressResponses: backend.responseCount - backend.completedResponseCount,\n    completionRate: backend.completionRate,\n    averageTime: 0,\n    views: backend.viewCount,\n  },\n  createdAt: backend.createdAt,\n  updatedAt: backend.createdAt,\n  publishedAt: backend.status === 2 ? backend.createdAt : undefined, // 2 = Published\n  coverImage: backend.coverImage || undefined,\n});\n\n/**\n * تحويل نوع المكون من رقم إلى معلومات النوع\n * Backend ComponentType Enum → Frontend ComponentType + QuestionType\n *\n * Backend Enum:\n * - أسئلة (1-14): SingleChoice=1, MultipleChoice=2, ShortText=3, LongText=4, Rating=5, LinearScale=6, Date=7, Time=8, Number=9, Dropdown=10, YesNo=11, Email=12, Phone=13, ChoiceGrid=14\n * - عرض (20-26): Heading=20, Paragraph=21, DisplayImage=22, DisplayVideo=23, Divider=24, DisplayLink=25, DisplayPdf=26\n * - تفاعلية (30-32): WordCloud=30, QA=31, Poll=32\n * - رفع ملفات (40-43): FileUpload=40, PdfUpload=41, ImageUpload=42, VideoUpload=43\n * - خاصة (50-52): Signature=50, Table=51, Link=52\n */\ninterface ComponentTypeInfo {\n  componentType: import(\"@/types/component\").ComponentType;\n  questionType?: import(\"@/types/component\").QuestionType;\n  displayType?: import(\"@/types/component\").DisplayType;\n  ratingType?: import(\"@/types/component\").RatingType;\n}\n\nconst mapComponentType = (type: number): ComponentTypeInfo => {\n  // أسئلة (1-14)\n  if (type >= 1 && type <= 14) {\n    // Rating هو component منفصل في Frontend\n    if (type === 5) {\n      return { componentType: \"rating\" };\n    }\n\n    const questionTypes: Record<number, import(\"@/types/component\").QuestionType> = {\n      1: \"single_choice\",\n      2: \"multiple_choice\",\n      3: \"short_text\",\n      4: \"long_text\",\n      // 5 = Rating (معالج أعلاه)\n      6: \"linear_scale\",\n      7: \"date\",\n      8: \"time\",\n      9: \"number\",\n      10: \"dropdown\",\n      11: \"yes_no\",\n      12: \"email\",\n      13: \"phone\",\n      14: \"choice_grid\",\n    };\n\n    return {\n      componentType: \"question\",\n      questionType: questionTypes[type] || \"short_text\"\n    };\n  }\n\n  // عناصر عرض (20-26)\n  if (type >= 20 && type <= 26) {\n    // Paragraph/Text\n    if (type === 21) {\n      return { componentType: \"text\" };\n    }\n    // DisplayImage\n    if (type === 22) {\n      return { componentType: \"display\", displayType: \"image\" };\n    }\n    // DisplayVideo\n    if (type === 23) {\n      return { componentType: \"display\", displayType: \"link\" }; // video يُعرض كـ link\n    }\n    // DisplayLink\n    if (type === 25) {\n      return { componentType: \"display\", displayType: \"link\" };\n    }\n    // DisplayPdf\n    if (type === 26) {\n      return { componentType: \"display\", displayType: \"pdf\" };\n    }\n    // Heading, Divider\n    return { componentType: \"text\" };\n  }\n\n  // رفع ملفات (40-43)\n  if (type === 40) return { componentType: \"pdf_upload\" }; // FileUpload عام → pdf_upload\n  if (type === 41) return { componentType: \"pdf_upload\" };\n  if (type === 42) return { componentType: \"image_upload\" };\n  if (type === 43) return { componentType: \"video_upload\" };\n\n  // عناصر خاصة (50-52)\n  if (type === 50) return { componentType: \"signature\" };\n  if (type === 51) return { componentType: \"table\" };\n  if (type === 52) return { componentType: \"link\" };\n\n  // Default: question مع short_text\n  return { componentType: \"question\", questionType: \"short_text\" };\n};\n\n/**\n * تحويل المكون من Backend إلى Frontend\n * يدعم جميع أنواع المكونات: question, rating, signature, file uploads, table, display, text, link\n */\nexport const mapComponent = (backend: BackendComponentDto): import(\"@/types/component\").Component => {\n  // Parse JSON fields\n  let options: any[] = [];\n  let correctAnswer: any = null;\n  let styleData: any = {};\n\n  if (backend.optionsJson) {\n    try {\n      options = JSON.parse(backend.optionsJson);\n    } catch (e) {\n      console.warn(\"Failed to parse optionsJson:\", e);\n    }\n  }\n\n  if (backend.correctAnswerJson) {\n    try {\n      correctAnswer = JSON.parse(backend.correctAnswerJson);\n    } catch (e) {\n      console.warn(\"Failed to parse correctAnswerJson:\", e);\n    }\n  }\n\n  if (backend.styleJson) {\n    try {\n      styleData = JSON.parse(backend.styleJson);\n    } catch (e) {\n      console.warn(\"Failed to parse styleJson:\", e);\n    }\n  }\n\n  // الحصول على معلومات النوع\n  const typeInfo = mapComponentType(backend.type);\n\n  // بناء Settings حسب نوع المكون\n  let settings: import(\"@/types/component\").ComponentSettings;\n\n  switch (typeInfo.componentType) {\n    case \"question\":\n      settings = {\n        type: \"question\",\n        label: backend.title || \"\",\n        description: backend.description || \"\",\n        questionType: typeInfo.questionType || \"short_text\",\n        placeholder: backend.placeholder || \"\",\n        required: backend.isRequired,\n        choices: options.map((opt: any, index: number) => ({\n          id: opt.id || `choice-${index}`,\n          label: opt.label || opt.text || opt,\n          value: opt.value || opt.label || opt,\n          isCorrect: correctAnswer === opt.id || (Array.isArray(correctAnswer) && correctAnswer.includes(opt.id)),\n        })),\n        scaleMin: backend.minValue || undefined,\n        scaleMax: backend.maxValue || undefined,\n        scaleMinLabel: backend.minLabel || undefined,\n        scaleMaxLabel: backend.maxLabel || undefined,\n        points: backend.points || undefined,\n        correctAnswer: correctAnswer || undefined,\n      };\n      break;\n\n    case \"rating\":\n      settings = {\n        type: \"rating\",\n        label: backend.title || \"تقييم\",\n        description: backend.description || \"\",\n        ratingType: (styleData.ratingType as any) || \"stars\",\n        required: backend.isRequired,\n        maxRating: backend.maxValue || 5,\n      };\n      break;\n\n    case \"signature\":\n      settings = {\n        type: \"signature\",\n        label: backend.title || \"التوقيع\",\n        description: backend.description || \"\",\n        required: backend.isRequired,\n        width: styleData.width || 500,\n        height: styleData.height || 200,\n        penColor: styleData.penColor || \"#000000\",\n        penWidth: styleData.penWidth || 2,\n      };\n      break;\n\n    case \"pdf_upload\":\n    case \"image_upload\":\n    case \"video_upload\":\n      settings = {\n        type: typeInfo.componentType,\n        label: backend.title || \"رفع ملف\",\n        description: backend.description || \"\",\n        required: backend.isRequired,\n        maxFileSize: styleData.maxFileSize || 10,\n        acceptedFileTypes: styleData.acceptedFileTypes || [],\n        allowMultiple: styleData.allowMultiple || false,\n        maxFiles: styleData.maxFiles || 1,\n      };\n      break;\n\n    case \"table\":\n      settings = {\n        type: \"table\",\n        label: backend.title || \"جدول\",\n        description: backend.description || \"\",\n        tableType: (styleData.tableType as any) || \"simple\",\n        columns: styleData.columns || [],\n        rowCount: styleData.rowCount || 3,\n        tableData: styleData.tableData || {},\n        calculations: styleData.calculations || [],\n      };\n      break;\n\n    case \"link\":\n      settings = {\n        type: \"link\",\n        label: backend.title || \"رابط\",\n        description: backend.description || \"\",\n        required: backend.isRequired,\n        placeholder: backend.placeholder || \"https://\",\n        validateUrl: true,\n      };\n      break;\n\n    case \"text\":\n      settings = {\n        type: \"text\",\n        content: backend.description || styleData.content || \"\",\n        fontSize: styleData.fontSize || \"medium\",\n        textAlign: styleData.textAlign || \"right\",\n        textColor: styleData.textColor,\n        backgroundColor: styleData.backgroundColor,\n      };\n      break;\n\n    case \"display\":\n      settings = {\n        type: \"display\",\n        label: backend.title || \"\",\n        description: backend.description || \"\",\n        displayType: typeInfo.displayType || \"image\",\n        imageUrl: backend.mediaUrl || styleData.imageUrl,\n        imageAlt: styleData.imageAlt,\n        pdfUrl: backend.mediaUrl || styleData.pdfUrl,\n        pdfFileName: styleData.pdfFileName,\n        linkUrl: backend.mediaUrl || styleData.linkUrl,\n        linkText: styleData.linkText,\n        openInNewTab: styleData.openInNewTab ?? true,\n      };\n      break;\n\n    default:\n      // Fallback to question\n      settings = {\n        type: \"question\",\n        label: backend.title || \"\",\n        description: backend.description || \"\",\n        questionType: \"short_text\",\n        placeholder: backend.placeholder || \"\",\n        required: backend.isRequired,\n      };\n  }\n\n  return {\n    id: backend.id,\n    sectionId: backend.sectionId,\n    type: typeInfo.componentType, // ✅ النوع الفعلي بدلاً من \"question\" الثابت\n    order: backend.order,\n    settings,\n    createdAt: backend.createdAt,\n    updatedAt: backend.updatedAt || backend.createdAt,\n  };\n};\n\n/**\n * تحويل القسم مع المكونات من Backend إلى Frontend\n */\nexport const mapSectionWithComponents = (backend: BackendSectionWithComponentsDto): import(\"@/types/section\").Section => ({\n  id: backend.id,\n  eventId: backend.eventId,\n  title: backend.title,\n  description: backend.description || undefined,\n  order: backend.order,\n  components: backend.components?.map(mapComponent) || [],\n  settings: {\n    visible: backend.isVisible,\n    skippable: false,\n    showProgress: true,\n    allowBackNavigation: true,\n  },\n  createdAt: backend.createdAt,\n  updatedAt: backend.createdAt,\n});\n\n/**\n * تحويل الحدث مع التفاصيل الكاملة\n */\nexport const mapEventWithFullDetails = (backend: BackendEventWithFullDetailsDto): Event => ({\n  ...mapEvent(backend),\n  sections: backend.sections?.map(mapSectionWithComponents) || [],\n});\n\n// ============================================================\n// Mappers: Frontend → Backend\n// ============================================================\n\n/**\n * تحويل نوع الحدث من نص إلى رقم\n * Frontend Type: \"survey\" | \"poll\" | \"form\" | \"quiz\"\n * Backend Enum: Survey=1, Quiz=2, Form=3, Event=4\n */\nconst mapEventTypeToNumber = (type: EventType): number => {\n  const types: Record<EventType, number> = {\n    survey: 1,  // Survey = 1\n    quiz: 2,    // Quiz = 2\n    form: 3,    // Form = 3\n    poll: 4,    // Event = 4 (poll في الـ Frontend = Event في الـ Backend)\n  };\n  return types[type] ?? 1; // Default: Survey\n};\n\n/**\n * تحويل حالة الحدث من نص إلى رقم\n * Frontend Status: \"draft\" | \"active\" | \"archived\"\n * Backend Enum: Draft=1, Published=2, Closed=3, Archived=4\n */\nexport const mapEventStatusToNumber = (status: EventStatus): number => {\n  const statuses: Record<EventStatus, number> = {\n    draft: 1,     // Draft = 1\n    active: 2,    // Published = 2\n    archived: 4,  // Archived = 4\n  };\n  return statuses[status] ?? 1; // Default: Draft\n};\n\n/**\n * تحويل بيانات إنشاء/تحديث جهة اتصال\n */\nexport const mapContactFormToBackend = (data: ContactFormData) => ({\n  name: data.name,\n  email: data.email || null,\n  phone: data.phone || null,\n  company: data.company || null,\n  jobTitle: data.jobTitle || null,\n  notes: data.notes || null,\n  tags: data.tags || [],\n  groupIds: data.groupIds || [],\n});\n\n/**\n * تحويل بيانات إنشاء/تحديث مجموعة\n */\nexport const mapGroupFormToBackend = (data: GroupFormData) => ({\n  name: data.name,\n  description: data.description || null,\n  color: data.color || \"#1a56db\",\n  icon: data.icon || null,\n  contactIds: data.contactIds || [],\n});\n\n/**\n * تحويل بيانات إنشاء/تحديث حدث\n */\nexport const mapEventFormToBackend = (data: EventFormData) => ({\n  title: data.title,\n  description: data.description || null,\n  type: mapEventTypeToNumber(data.type),\n  status: mapEventStatusToNumber(data.status),\n  coverImage: data.coverImage || null,\n  requireLogin: data.settings?.requireAuth || data.settings?.requireLogin || false,\n  allowAnonymous: data.settings?.allowAnonymous ?? true,\n  allowMultipleResponses: data.settings?.allowMultipleResponses || false,\n  allowEditResponses: data.settings?.allowEdit || false,\n  showResults: data.settings?.showResults || false,\n  showCorrectAnswers: data.settings?.showCorrectAnswers || false,\n  shuffleQuestions: data.settings?.shuffleQuestions || false,\n  timeLimitMinutes: data.settings?.timeLimit || null,\n  passingScore: data.settings?.passingScore || null,\n  startDate: data.settings?.startDate || null,\n  endDate: data.settings?.endDate || null,\n});\n\n/**\n * تحويل نوع السؤال من نص إلى رقم\n * Frontend QuestionType → Backend ComponentType Enum\n *\n * Backend Enum الجديد:\n * - SingleChoice=1, MultipleChoice=2, ShortText=3, LongText=4, Rating=5\n * - LinearScale=6, Date=7, Time=8, Number=9, Dropdown=10, YesNo=11\n * - Email=12, Phone=13, ChoiceGrid=14\n */\nconst mapQuestionTypeToNumber = (questionType: string): number => {\n  const types: Record<string, number> = {\n    \"single_choice\": 1,\n    \"multiple_choice\": 2,\n    \"short_text\": 3,\n    \"long_text\": 4,\n    // Rating handled separately as component type\n    \"linear_scale\": 6,\n    \"date\": 7,\n    \"time\": 8,\n    \"number\": 9,\n    \"dropdown\": 10,\n    \"yes_no\": 11,\n    \"email\": 12,\n    \"phone\": 13,\n    \"choice_grid\": 14,\n  };\n  return types[questionType] || 3; // Default to short_text\n};\n\n/**\n * تحويل نوع المكون (Component Type) من Frontend إلى Backend\n * يشمل جميع أنواع المكونات وليس فقط الأسئلة\n */\nconst mapComponentTypeToNumber = (component: import(\"@/types/component\").Component): number => {\n  const settings = component.settings as any;\n\n  switch (component.type) {\n    case \"question\":\n      return mapQuestionTypeToNumber(settings.questionType || \"short_text\");\n\n    case \"rating\":\n      return 5; // Rating = 5\n\n    case \"pdf_upload\":\n      return 41; // PdfUpload = 41\n\n    case \"image_upload\":\n      return 42; // ImageUpload = 42\n\n    case \"video_upload\":\n      return 43; // VideoUpload = 43\n\n    case \"signature\":\n      return 50; // Signature = 50\n\n    case \"table\":\n      return 51; // Table = 51\n\n    case \"link\":\n      return 52; // Link = 52\n\n    case \"text\":\n      return 21; // Paragraph = 21\n\n    case \"display\":\n      // Display type depends on displayType setting\n      const displayType = settings.displayType;\n      if (displayType === \"image\") return 22; // DisplayImage = 22\n      if (displayType === \"pdf\") return 26; // DisplayPdf = 26\n      if (displayType === \"link\") return 25; // DisplayLink = 25\n      return 22; // Default to DisplayImage\n\n    default:\n      return 3; // Default to ShortText\n  }\n};\n\n/**\n * تحويل المكون من Frontend إلى Backend\n * يدعم جميع أنواع المكونات مع حفظ الإعدادات الخاصة بكل نوع في styleJson\n */\nexport const mapComponentToBackend = (component: import(\"@/types/component\").Component, order: number) => {\n  const settings = component.settings as any;\n\n  // القيم الأساسية المشتركة\n  let optionsJson: string | null = null;\n  let correctAnswerJson: string | null = null;\n  let styleJson: string | null = null;\n  let mediaUrl: string | null = null;\n  let mediaType: string | null = null;\n  let minValue: number | null = null;\n  let maxValue: number | null = null;\n\n  // معالجة حسب نوع المكون\n  switch (component.type) {\n    case \"question\":\n      // تحويل الخيارات\n      if (settings.choices && settings.choices.length > 0) {\n        optionsJson = JSON.stringify(settings.choices.map((c: any) => ({\n          id: c.id,\n          label: c.label,\n          value: c.value,\n        })));\n      }\n      // تحويل الإجابة الصحيحة\n      if (settings.correctAnswer !== undefined) {\n        correctAnswerJson = JSON.stringify(settings.correctAnswer);\n      }\n      // للمقياس الخطي\n      minValue = settings.scaleMin || null;\n      maxValue = settings.scaleMax || null;\n      break;\n\n    case \"rating\":\n      maxValue = settings.maxRating || 5;\n      styleJson = JSON.stringify({\n        ratingType: settings.ratingType || \"stars\",\n        emojiSet: settings.emojiSet,\n      });\n      break;\n\n    case \"signature\":\n      styleJson = JSON.stringify({\n        width: settings.width || 500,\n        height: settings.height || 200,\n        penColor: settings.penColor || \"#000000\",\n        penWidth: settings.penWidth || 2,\n      });\n      break;\n\n    case \"pdf_upload\":\n    case \"image_upload\":\n    case \"video_upload\":\n      styleJson = JSON.stringify({\n        maxFileSize: settings.maxFileSize || 10,\n        acceptedFileTypes: settings.acceptedFileTypes || [],\n        allowMultiple: settings.allowMultiple || false,\n        maxFiles: settings.maxFiles || 1,\n      });\n      break;\n\n    case \"table\":\n      styleJson = JSON.stringify({\n        tableType: settings.tableType || \"simple\",\n        columns: settings.columns || [],\n        rowCount: settings.rowCount || 3,\n        tableData: settings.tableData || {},\n        calculations: settings.calculations || [],\n      });\n      break;\n\n    case \"link\":\n      styleJson = JSON.stringify({\n        validateUrl: settings.validateUrl ?? true,\n      });\n      break;\n\n    case \"text\":\n      styleJson = JSON.stringify({\n        content: settings.content || \"\",\n        fontSize: settings.fontSize || \"medium\",\n        textAlign: settings.textAlign || \"right\",\n        textColor: settings.textColor,\n        backgroundColor: settings.backgroundColor,\n      });\n      break;\n\n    case \"display\":\n      mediaUrl = settings.imageUrl || settings.pdfUrl || settings.linkUrl || null;\n      mediaType = settings.displayType || \"image\";\n      styleJson = JSON.stringify({\n        displayType: settings.displayType,\n        imageUrl: settings.imageUrl,\n        imageAlt: settings.imageAlt,\n        pdfUrl: settings.pdfUrl,\n        pdfFileName: settings.pdfFileName,\n        linkUrl: settings.linkUrl,\n        linkText: settings.linkText,\n        openInNewTab: settings.openInNewTab,\n      });\n      break;\n  }\n\n  return {\n    type: mapComponentTypeToNumber(component),\n    order: order,\n    title: settings.label || settings.content?.substring(0, 100) || null,\n    description: settings.description || null,\n    placeholder: settings.placeholder || null,\n    isRequired: settings.required || false,\n    isVisible: true,\n    optionsJson: optionsJson,\n    validationJson: null,\n    correctAnswerJson: correctAnswerJson,\n    points: settings.points || null,\n    explanation: null,\n    minValue: minValue,\n    maxValue: maxValue,\n    minLabel: settings.scaleMinLabel || settings.minLabel || null,\n    maxLabel: settings.scaleMaxLabel || settings.maxLabel || null,\n    mediaUrl: mediaUrl,\n    mediaType: mediaType,\n    styleJson: styleJson,\n  };\n};\n\n/**\n * تحويل القسم من Frontend إلى Backend\n */\nexport const mapSectionToBackend = (section: import(\"@/types/section\").Section, order: number) => ({\n  title: section.title,\n  description: section.description || null,\n  order: order,\n  isVisible: section.settings?.visible ?? true,\n  components: section.components?.map((comp, idx) => mapComponentToBackend(comp, idx)) || [],\n});\n\n/**\n * تحويل الحدث الكامل مع الأقسام والمكونات للـ Backend\n * يُستخدم مع endpoint /Events/with-sections\n */\nexport const mapEventWithSectionsToBackend = (event: Event) => ({\n  title: event.title,\n  description: event.description || null,\n  type: mapEventTypeToNumber(event.type),\n  coverImage: event.coverImage || null,\n  themeColor: event.settings?.themeColor || null,\n  language: event.settings?.language || \"ar\",\n  startDate: event.startDate || null,\n  endDate: event.endDate || null,\n  timeLimitMinutes: event.settings?.timeLimit || null,\n  requireLogin: event.settings?.requireAuth || event.settings?.requireLogin || false,\n  allowAnonymous: event.settings?.allowAnonymous ?? true,\n  maxResponses: event.settings?.maxResponses || null,\n  allowMultipleResponses: event.settings?.allowMultipleResponses || false,\n  allowEditResponses: event.settings?.allowEdit || false,\n  showResults: event.settings?.showResults || false,\n  showCorrectAnswers: event.settings?.showCorrectAnswers || false,\n  shuffleQuestions: event.settings?.shuffleQuestions || false,\n  shuffleOptions: event.settings?.shuffleOptions || false,\n  passingScore: event.settings?.passingScore || null,\n  thankYouMessage: event.settings?.thankYouMessage || null,\n  successMessage: event.settings?.successMessage || null,\n  goodMessage: event.settings?.goodMessage || null,\n  improvementMessage: event.settings?.improvementMessage || null,\n  sections: event.sections?.map((section, idx) => mapSectionToBackend(section, idx)) || [],\n});\n\n// ============================================================\n// Response DTOs و Mappers\n// ============================================================\n\nimport { Response, ComponentAnswer, ParticipantInfo, ResponseStatus } from \"@/types/response\";\n\n/**\n * الرد من Backend\n */\nexport interface BackendResponseDto {\n  id: string;\n  status: number; // ResponseStatus enum: Started=1, InProgress=2, Completed=3, Abandoned=4\n  respondentName: string | null;\n  respondentEmail: string | null;\n  respondentPhone: string | null;\n  answersJson: string;\n  startedAt: string;\n  completedAt: string | null;\n  durationSeconds: number | null;\n  score: number | null;\n  totalPoints: number | null;\n  percentage: number | null;\n  isPassed: boolean | null;\n  currentSectionIndex: number;\n  eventId: string;\n  createdAt: string;\n}\n\n/**\n * تحويل حالة الرد من رقم إلى نص\n * Backend Enum: Started=1, InProgress=2, Completed=3, Abandoned=4\n */\nconst mapResponseStatus = (status: number): ResponseStatus => {\n  const statuses: Record<number, ResponseStatus> = {\n    1: \"in_progress\",   // Started - بدأ (نعتبره in_progress)\n    2: \"in_progress\",   // InProgress - قيد التقدم\n    3: \"completed\",     // Completed - مكتمل\n    4: \"abandoned\",     // Abandoned - متروك\n  };\n  return statuses[status] || \"in_progress\";\n};\n\n/**\n * تحويل الرد من Backend إلى Frontend\n */\nexport const mapResponse = (backend: BackendResponseDto): Response => {\n  // Parse answers from JSON\n  let answers: ComponentAnswer[] = [];\n  if (backend.answersJson) {\n    try {\n      const parsedAnswers = JSON.parse(backend.answersJson);\n      // Transform from object { componentId: answer } to array\n      if (typeof parsedAnswers === \"object\" && !Array.isArray(parsedAnswers)) {\n        answers = Object.entries(parsedAnswers).map(([componentId, answer]) => {\n          // Parse the answer if it's a JSON string (double-encoded from backend)\n          let parsedAnswer = answer;\n          if (typeof answer === \"string\") {\n            try {\n              parsedAnswer = JSON.parse(answer);\n            } catch {\n              // Not JSON, keep as string (for simple text answers)\n              parsedAnswer = answer;\n            }\n          }\n\n          return {\n            componentId,\n            componentType: \"unknown\", // Will be determined by UI\n            answer: parsedAnswer as any,\n            timeSpent: 0,\n            answeredAt: backend.createdAt,\n          };\n        });\n      } else if (Array.isArray(parsedAnswers)) {\n        answers = parsedAnswers;\n      }\n    } catch (e) {\n      console.warn(\"Failed to parse answersJson:\", e);\n    }\n  }\n\n  // Build participant info\n  const participant: ParticipantInfo = {\n    name: backend.respondentName || undefined,\n    email: backend.respondentEmail || undefined,\n    phone: backend.respondentPhone || undefined,\n  };\n\n  // Build score if available\n  const score = backend.score !== null && backend.totalPoints !== null ? {\n    totalPoints: backend.totalPoints,\n    earnedPoints: backend.score,\n    percentage: backend.percentage || 0,\n    passed: backend.isPassed || false,\n  } : undefined;\n\n  // Calculate time spent\n  const timeSpent = backend.durationSeconds || 0;\n\n  return {\n    id: backend.id,\n    eventId: backend.eventId,\n    participant,\n    answers,\n    status: mapResponseStatus(backend.status),\n    timeSpent,\n    score,\n    progress: backend.status === 3 ? 100 : (backend.currentSectionIndex * 10), // Estimate progress (3 = Completed)\n    metadata: {\n      device: \"desktop\", // Default - not stored in backend\n      browser: \"Unknown\",\n      os: \"Unknown\",\n      language: \"ar\",\n      sessionId: backend.id,\n    },\n    startedAt: backend.startedAt,\n    completedAt: backend.completedAt || undefined,\n    lastUpdatedAt: backend.completedAt || backend.startedAt,\n  };\n};\n\n/**\n * تحويل إجابات القسم من Frontend إلى Backend\n */\nexport const mapSectionAnswersToBackend = (answers: ComponentAnswer[]): Array<{\n  componentId: string;\n  answerJson: string;\n}> => {\n  return answers.map(answer => ({\n    componentId: answer.componentId,\n    answerJson: JSON.stringify(answer.answer),\n  }));\n};\n\n/**\n * تحويل طلب بدء الاستجابة من Frontend إلى Backend\n */\nexport const mapResponseToBackendStart = (participantInfo?: ParticipantInfo) => ({\n  respondentName: participantInfo?.name || null,\n  respondentEmail: participantInfo?.email || null,\n  respondentPhone: participantInfo?.phone || null,\n});\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1065, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/services/authService.ts"],"sourcesContent":["/**\n * Auth Service - خدمة المصادقة\n * الاتصال بـ Backend API للمصادقة\n */\n\nimport { apiClient, ApiResponse, tokenManager } from \"../client\";\nimport { BackendAuthResponse, BackendUserDto, mapAuthResponse, mapUser } from \"../mappers\";\nimport { LoginData, SignupData, User } from \"@/types/auth\";\n\n// ============================================================\n// أنواع الاستجابات\n// ============================================================\n\ninterface AuthResult {\n  user: User;\n  token: string;\n  refreshToken: string;\n}\n\n// ============================================================\n// خدمة المصادقة\n// ============================================================\n\nexport const authService = {\n  /**\n   * تسجيل الدخول\n   */\n  login: async (data: LoginData): Promise<AuthResult> => {\n    const response = await apiClient.post<ApiResponse<BackendAuthResponse>>(\n      \"/Auth/login\",\n      {\n        email: data.email,\n        password: data.password,\n        rememberMe: data.rememberMe || false,\n      }\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تسجيل الدخول\");\n    }\n\n    const result = mapAuthResponse(response.data.data);\n    \n    // حفظ التوكنات\n    tokenManager.setTokens(result.token, result.refreshToken);\n\n    return result;\n  },\n\n  /**\n   * إنشاء حساب جديد\n   */\n  register: async (data: SignupData): Promise<AuthResult> => {\n    const response = await apiClient.post<ApiResponse<BackendAuthResponse>>(\n      \"/Auth/register\",\n      {\n        fullName: data.name,\n        email: data.email,\n        password: data.password,\n        confirmPassword: data.confirmPassword,\n        phone: data.phone || null,\n      }\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إنشاء الحساب\");\n    }\n\n    const result = mapAuthResponse(response.data.data);\n    \n    // حفظ التوكنات\n    tokenManager.setTokens(result.token, result.refreshToken);\n\n    return result;\n  },\n\n  /**\n   * تسجيل الخروج\n   */\n  logout: async (): Promise<void> => {\n    try {\n      await apiClient.post(\"/Auth/logout\");\n    } finally {\n      // مسح التوكنات في جميع الحالات\n      tokenManager.clearTokens();\n    }\n  },\n\n  /**\n   * الحصول على بيانات المستخدم الحالي\n   */\n  getCurrentUser: async (): Promise<User> => {\n    const response = await apiClient.get<ApiResponse<BackendUserDto>>(\"/Auth/me\");\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل جلب بيانات المستخدم\");\n    }\n\n    return mapUser(response.data.data);\n  },\n\n  /**\n   * تحديث الملف الشخصي\n   */\n  updateProfile: async (data: {\n    name?: string;\n    phone?: string;\n    avatar?: string;\n  }): Promise<User> => {\n    const response = await apiClient.put<ApiResponse<BackendUserDto>>(\n      \"/Auth/profile\",\n      {\n        fullName: data.name,\n        phone: data.phone || null,\n        profileImage: data.avatar || null,\n      }\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تحديث الملف الشخصي\");\n    }\n\n    return mapUser(response.data.data);\n  },\n\n  /**\n   * تغيير كلمة المرور\n   */\n  changePassword: async (data: {\n    currentPassword: string;\n    newPassword: string;\n    confirmNewPassword: string;\n  }): Promise<void> => {\n    const response = await apiClient.post<ApiResponse<null>>(\"/Auth/change-password\", data);\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل تغيير كلمة المرور\");\n    }\n  },\n\n  /**\n   * نسيت كلمة المرور\n   */\n  forgotPassword: async (email: string): Promise<void> => {\n    const response = await apiClient.post<ApiResponse<null>>(\"/Auth/forgot-password\", {\n      email,\n    });\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل إرسال رابط استعادة كلمة المرور\");\n    }\n  },\n\n  /**\n   * إعادة تعيين كلمة المرور\n   */\n  resetPassword: async (data: {\n    token: string;\n    email: string;\n    newPassword: string;\n    confirmPassword: string;\n  }): Promise<void> => {\n    const response = await apiClient.post<ApiResponse<null>>(\"/Auth/reset-password\", data);\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل إعادة تعيين كلمة المرور\");\n    }\n  },\n\n  /**\n   * التحقق من صحة التوكن\n   */\n  verifyToken: async (): Promise<boolean> => {\n    if (!tokenManager.hasValidToken()) {\n      return false;\n    }\n\n    try {\n      await authService.getCurrentUser();\n      return true;\n    } catch {\n      tokenManager.clearTokens();\n      return false;\n    }\n  },\n};\n\nexport default authService;\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAED;AACA;;;AAiBO,MAAM,cAAc;IACzB;;GAEC,GACD,OAAO,OAAO;QACZ,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,eACA;YACE,OAAO,KAAK,KAAK;YACjB,UAAU,KAAK,QAAQ;YACvB,YAAY,KAAK,UAAU,IAAI;QACjC;QAGF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,MAAM,SAAS,IAAA,6JAAe,EAAC,SAAS,IAAI,CAAC,IAAI;QAEjD,eAAe;QACf,yJAAY,CAAC,SAAS,CAAC,OAAO,KAAK,EAAE,OAAO,YAAY;QAExD,OAAO;IACT;IAEA;;GAEC,GACD,UAAU,OAAO;QACf,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,kBACA;YACE,UAAU,KAAK,IAAI;YACnB,OAAO,KAAK,KAAK;YACjB,UAAU,KAAK,QAAQ;YACvB,iBAAiB,KAAK,eAAe;YACrC,OAAO,KAAK,KAAK,IAAI;QACvB;QAGF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,MAAM,SAAS,IAAA,6JAAe,EAAC,SAAS,IAAI,CAAC,IAAI;QAEjD,eAAe;QACf,yJAAY,CAAC,SAAS,CAAC,OAAO,KAAK,EAAE,OAAO,YAAY;QAExD,OAAO;IACT;IAEA;;GAEC,GACD,QAAQ;QACN,IAAI;YACF,MAAM,sJAAS,CAAC,IAAI,CAAC;QACvB,SAAU;YACR,+BAA+B;YAC/B,yJAAY,CAAC,WAAW;QAC1B;IACF;IAEA;;GAEC,GACD,gBAAgB;QACd,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAA8B;QAElE,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,qJAAO,EAAC,SAAS,IAAI,CAAC,IAAI;IACnC;IAEA;;GAEC,GACD,eAAe,OAAO;QAKpB,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,iBACA;YACE,UAAU,KAAK,IAAI;YACnB,OAAO,KAAK,KAAK,IAAI;YACrB,cAAc,KAAK,MAAM,IAAI;QAC/B;QAGF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,qJAAO,EAAC,SAAS,IAAI,CAAC,IAAI;IACnC;IAEA;;GAEC,GACD,gBAAgB,OAAO;QAKrB,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CAAoB,yBAAyB;QAElF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,EAAE;YAC1B,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;IACF;IAEA;;GAEC,GACD,gBAAgB,OAAO;QACrB,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CAAoB,yBAAyB;YAChF;QACF;QAEA,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,EAAE;YAC1B,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;IACF;IAEA;;GAEC,GACD,eAAe,OAAO;QAMpB,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CAAoB,wBAAwB;QAEjF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,EAAE;YAC1B,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;IACF;IAEA;;GAEC,GACD,aAAa;QACX,IAAI,CAAC,yJAAY,CAAC,aAAa,IAAI;YACjC,OAAO;QACT;QAEA,IAAI;YACF,MAAM,YAAY,cAAc;YAChC,OAAO;QACT,EAAE,OAAM;YACN,yJAAY,CAAC,WAAW;YACxB,OAAO;QACT;IACF;AACF;uCAEe","debugId":null}},
    {"offset": {"line": 1194, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/services/eventsService.ts"],"sourcesContent":["/**\n * Events Service - خدمة الأحداث\n * الاتصال بـ Backend API للأحداث\n */\n\nimport { apiClient, ApiResponse } from \"../client\";\nimport {\n  BackendEventDto,\n  BackendEventListItemDto,\n  BackendEventWithFullDetailsDto,\n  BackendPagedResult,\n  mapEvent,\n  mapEventListItem,\n  mapEventWithFullDetails,\n  mapEventFormToBackend,\n  mapEventWithSectionsToBackend,\n  mapEventStatusToNumber\n} from \"../mappers\";\nimport { Event, EventFormData, EventStatus, EventType } from \"@/types/event\";\n\n// ============================================================\n// أنواع إضافية\n// ============================================================\n\ninterface SendEventRequest {\n  contactIds?: string[];\n  groupIds?: string[];\n  sendMethod: \"email\" | \"sms\" | \"both\";\n  customMessage?: string;\n}\n\ninterface SendEventResponse {\n  totalRecipients: number;\n  // Backend يرسل SuccessCount و FailureCount\n  successCount?: number;\n  failureCount?: number;\n  // للتوافق مع الأسماء القديمة\n  successfulSends?: number;\n  failedSends?: number;\n  errors?: string[] | null;\n  sentAt?: string;\n}\n\n// DTO للإحصائيات اليومية\nexport interface DailyStats {\n  date: string;\n  events: number;\n  responses: number;\n}\n\n// DTO لإحصائيات لوحة التحكم\nexport interface DashboardStats {\n  totalEvents: number;\n  activeEvents: number;\n  totalResponses: number;\n  totalViews: number;\n  averageCompletionRate: number;\n  eventsChange: number;\n  activeEventsChange: number;\n  responsesChange: number;\n  viewsChange: number;\n  completionRateChange: number;\n  dailyStats: DailyStats[];\n}\n\n// ============================================================\n// خدمة الأحداث\n// ============================================================\n\nexport const eventsService = {\n  /**\n   * جلب جميع الأحداث (مع Pagination)\n   * Backend يُرجع PagedResult<EventListItemDto>\n   */\n  getAll: async (): Promise<Event[]> => {\n    const response = await apiClient.get<ApiResponse<BackendPagedResult<BackendEventListItemDto>>>(\"/Events\");\n\n    console.log(\"📡 API Response:\", response.data);\n    console.log(\"📡 API Response - items:\", response.data.data?.items);\n\n    // Log ALL properties of first item to see the actual property names\n    if (response.data.data?.items?.[0]) {\n      console.log(\"📡 First item ALL KEYS:\", Object.keys(response.data.data.items[0]));\n      console.log(\"📡 First item RAW:\", JSON.stringify(response.data.data.items[0], null, 2));\n    }\n\n    // Log each item's title specifically\n    response.data.data?.items?.forEach((item, index) => {\n      console.log(`📡 Item ${index} - title:`, item.title, \"| type:\", typeof item.title);\n      // Also try Title (PascalCase)\n      console.log(`📡 Item ${index} - Title (PascalCase):`, (item as any).Title);\n    });\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل جلب الأحداث\");\n    }\n\n    // استخراج الـ items من الاستجابة المُرقّمة\n    const events = response.data.data.items.map(mapEventListItem);\n    console.log(\"📋 Mapped Events:\", events);\n\n    // Log each mapped event's title\n    events.forEach((event, index) => {\n      console.log(`📋 Mapped Event ${index} - title:`, event.title, \"| type:\", typeof event.title);\n    });\n\n    return events;\n  },\n\n  /**\n   * جلب حدث بواسطة ID\n   */\n  getById: async (id: string): Promise<Event> => {\n    const response = await apiClient.get<ApiResponse<BackendEventDto>>(`/Events/${id}`);\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"الحدث غير موجود\");\n    }\n\n    return mapEvent(response.data.data);\n  },\n\n  /**\n   * جلب حدث مع التفاصيل الكاملة (sections و components)\n   */\n  getFullDetails: async (id: string): Promise<Event> => {\n    const response = await apiClient.get<ApiResponse<BackendEventWithFullDetailsDto>>(\n      `/Events/${id}/full`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"الحدث غير موجود\");\n    }\n\n    return mapEventWithFullDetails(response.data.data);\n  },\n\n  /**\n   * جلب حدث بواسطة رمز المشاركة (Public - لا يحتاج تسجيل دخول)\n   * يُرجع الحدث مع التفاصيل الكاملة (sections و components)\n   */\n  getByShareCode: async (shareCode: string): Promise<Event> => {\n    const response = await apiClient.get<ApiResponse<BackendEventWithFullDetailsDto>>(\n      `/Public/events/${shareCode}`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"الحدث غير موجود\");\n    }\n\n    return mapEventWithFullDetails(response.data.data);\n  },\n\n  /**\n   * جلب حدث للمعاينة (Public - لا يحتاج تسجيل دخول - بدون التحقق من الحالة)\n   * يُرجع الحدث مع التفاصيل الكاملة (sections و components)\n   */\n  getForPreview: async (id: string): Promise<Event> => {\n    const response = await apiClient.get<ApiResponse<BackendEventWithFullDetailsDto>>(\n      `/Public/events/${id}/preview`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"الحدث غير موجود\");\n    }\n\n    return mapEventWithFullDetails(response.data.data);\n  },\n\n  /**\n   * جلب الأحداث حسب الحالة\n   * Backend Enum: Draft=1, Published=2, Closed=3, Archived=4\n   * Backend يُرجع List<EventListItemDto>\n   */\n  getByStatus: async (status: EventStatus): Promise<Event[]> => {\n    const statusNumber = { draft: 1, active: 2, archived: 4 }[status];\n    const response = await apiClient.get<ApiResponse<BackendEventListItemDto[]>>(\n      `/Events/by-status/${statusNumber}`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      return [];\n    }\n\n    return response.data.data.map(mapEventListItem);\n  },\n\n  /**\n   * جلب الأحداث حسب النوع\n   * Backend Enum: Survey=1, Quiz=2, Form=3, Event=4\n   * Backend يُرجع List<EventListItemDto>\n   */\n  getByType: async (type: EventType): Promise<Event[]> => {\n    const typeNumber = { survey: 1, quiz: 2, form: 3, poll: 4 }[type];\n    const response = await apiClient.get<ApiResponse<BackendEventListItemDto[]>>(\n      `/Events/by-type/${typeNumber}`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      return [];\n    }\n\n    return response.data.data.map(mapEventListItem);\n  },\n\n  /**\n   * إنشاء حدث جديد (بدون أقسام)\n   */\n  create: async (data: EventFormData): Promise<Event> => {\n    console.log(\"🔵 Creating event with data:\", data);\n    const backendData = mapEventFormToBackend(data);\n    console.log(\"🔵 Backend data:\", backendData);\n\n    const response = await apiClient.post<ApiResponse<BackendEventDto>>(\n      \"/Events\",\n      backendData\n    );\n\n    console.log(\"🔵 API Response:\", response.data);\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إنشاء الحدث\");\n    }\n\n    return mapEvent(response.data.data);\n  },\n\n  /**\n   * إنشاء حدث كامل مع الأقسام والمكونات\n   * يُستخدم عند حفظ الحدث من Event Builder\n   */\n  createWithSections: async (event: Event): Promise<Event> => {\n    console.log(\"🔵 Creating event with sections:\", event);\n    const backendData = mapEventWithSectionsToBackend(event);\n    console.log(\"🔵 Backend data with sections:\", backendData);\n\n    const response = await apiClient.post<ApiResponse<BackendEventWithFullDetailsDto>>(\n      \"/Events/with-sections\",\n      backendData\n    );\n\n    console.log(\"🔵 API Response:\", response.data);\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إنشاء الحدث\");\n    }\n\n    return mapEventWithFullDetails(response.data.data);\n  },\n\n  /**\n   * تحديث حدث\n   */\n  update: async (id: string, data: Partial<EventFormData>): Promise<Event> => {\n    const response = await apiClient.put<ApiResponse<BackendEventDto>>(\n      `/Events/${id}`,\n      mapEventFormToBackend(data as EventFormData)\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تحديث الحدث\");\n    }\n\n    return mapEvent(response.data.data);\n  },\n\n  /**\n   * تحديث حدث كامل مع الأقسام والمكونات\n   * يُستخدم عند تعديل الحدث من Event Builder\n   */\n  updateWithSections: async (id: string, event: Event): Promise<Event> => {\n    console.log(\"🔵 Updating event with sections:\", event);\n    const backendData = mapEventWithSectionsToBackend(event);\n    console.log(\"🔵 Backend data for update:\", backendData);\n\n    const response = await apiClient.put<ApiResponse<BackendEventWithFullDetailsDto>>(\n      `/Events/${id}/with-sections`,\n      backendData\n    );\n\n    console.log(\"🔵 Update API Response:\", response.data);\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تحديث الحدث\");\n    }\n\n    return mapEventWithFullDetails(response.data.data);\n  },\n\n  /**\n   * تحديث حالة الحدث فقط (بدون تغيير البيانات الأخرى)\n   */\n  updateStatus: async (id: string, status: EventStatus): Promise<Event> => {\n    const statusNumber = mapEventStatusToNumber(status);\n    const response = await apiClient.patch<ApiResponse<BackendEventDto>>(\n      `/Events/${id}/status`,\n      { status: statusNumber }\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تحديث حالة الحدث\");\n    }\n\n    return mapEvent(response.data.data);\n  },\n\n  /**\n   * حذف حدث\n   */\n  delete: async (id: string): Promise<void> => {\n    const response = await apiClient.delete<ApiResponse<null>>(`/Events/${id}`);\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل حذف الحدث\");\n    }\n  },\n\n  /**\n   * نشر حدث\n   */\n  publish: async (id: string): Promise<Event> => {\n    const response = await apiClient.post<ApiResponse<BackendEventDto>>(\n      `/Events/${id}/publish`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل نشر الحدث\");\n    }\n\n    return mapEvent(response.data.data);\n  },\n\n  /**\n   * إغلاق حدث (تحويل إلى مسودة)\n   */\n  close: async (id: string): Promise<Event> => {\n    const response = await apiClient.post<ApiResponse<BackendEventDto>>(\n      `/Events/${id}/close`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إغلاق الحدث\");\n    }\n\n    return mapEvent(response.data.data);\n  },\n\n  /**\n   * نسخ حدث\n   */\n  duplicate: async (id: string): Promise<Event> => {\n    const response = await apiClient.post<ApiResponse<BackendEventDto>>(\n      `/Events/${id}/duplicate`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل نسخ الحدث\");\n    }\n\n    return mapEvent(response.data.data);\n  },\n\n  /**\n   * إرسال حدث لجهات الاتصال\n   */\n  send: async (id: string, data: SendEventRequest): Promise<SendEventResponse> => {\n    const response = await apiClient.post<ApiResponse<SendEventResponse>>(\n      `/Events/${id}/send`,\n      {\n        contactIds: data.contactIds || [],\n        groupIds: data.groupIds || [],\n        sendMethod: data.sendMethod === \"email\" ? 0 : data.sendMethod === \"sms\" ? 1 : 2,\n        customMessage: data.customMessage || null,\n      }\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إرسال الحدث\");\n    }\n\n    return response.data.data;\n  },\n\n  /**\n   * إرسال تذكير\n   */\n  sendReminder: async (id: string, contactIds: string[]): Promise<SendEventResponse> => {\n    const response = await apiClient.post<ApiResponse<SendEventResponse>>(\n      `/Events/${id}/send-reminder`,\n      { contactIds }\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إرسال التذكير\");\n    }\n\n    return response.data.data;\n  },\n\n  /**\n   * جلب سجل الإرسال\n   */\n  getSendHistory: async (\n    id: string\n  ): Promise<\n    Array<{\n      id: string;\n      contactId: string;\n      contactName: string;\n      contactEmail: string;\n      sentAt: string;\n      status: string;\n      openedAt?: string;\n      respondedAt?: string;\n    }>\n  > => {\n    const response = await apiClient.get<\n      ApiResponse<\n        Array<{\n          id: string;\n          contactId: string;\n          contactName: string;\n          contactEmail: string;\n          sentAt: string;\n          status: string;\n          openedAt: string | null;\n          respondedAt: string | null;\n        }>\n      >\n    >(`/Events/${id}/send-history`);\n\n    if (!response.data.success || !response.data.data) {\n      return [];\n    }\n\n    return response.data.data.map((item) => ({\n      ...item,\n      openedAt: item.openedAt || undefined,\n      respondedAt: item.respondedAt || undefined,\n    }));\n  },\n\n  /**\n   * زيادة عدد مشاهدات الحدث (Public - لا يحتاج تسجيل دخول)\n   */\n  incrementViewCount: async (eventId: string): Promise<void> => {\n    try {\n      await apiClient.post(`/Public/events/${eventId}/view`);\n    } catch (error) {\n      // لا نريد إيقاف تحميل الصفحة إذا فشل تسجيل المشاهدة\n      console.warn(\"Failed to increment view count:\", error);\n    }\n  },\n\n  /**\n   * جلب إحصائيات لوحة التحكم\n   */\n  getDashboardStats: async (): Promise<DashboardStats | null> => {\n    try {\n      const response = await apiClient.get<ApiResponse<DashboardStats>>(\n        \"/Events/dashboard-stats\"\n      );\n\n      if (!response.data.success || !response.data.data) {\n        return null;\n      }\n\n      return response.data.data;\n    } catch (error) {\n      console.error(\"Failed to fetch dashboard stats:\", error);\n      return null;\n    }\n  },\n};\n\nexport default eventsService;\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAED;AACA;;;AA+DO,MAAM,gBAAgB;IAC3B;;;GAGC,GACD,QAAQ;QACN,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAA2D;QAE/F,QAAQ,GAAG,CAAC,oBAAoB,SAAS,IAAI;QAC7C,QAAQ,GAAG,CAAC,4BAA4B,SAAS,IAAI,CAAC,IAAI,EAAE;QAE5D,oEAAoE;QACpE,IAAI,SAAS,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,EAAE,EAAE;YAClC,QAAQ,GAAG,CAAC,2BAA2B,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;YAC9E,QAAQ,GAAG,CAAC,sBAAsB,KAAK,SAAS,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM;QACtF;QAEA,qCAAqC;QACrC,SAAS,IAAI,CAAC,IAAI,EAAE,OAAO,QAAQ,CAAC,MAAM;YACxC,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,MAAM,SAAS,CAAC,EAAE,KAAK,KAAK,EAAE,WAAW,OAAO,KAAK,KAAK;YACjF,8BAA8B;YAC9B,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,MAAM,sBAAsB,CAAC,EAAE,AAAC,KAAa,KAAK;QAC3E;QAEA,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,2CAA2C;QAC3C,MAAM,SAAS,SAAS,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,8JAAgB;QAC5D,QAAQ,GAAG,CAAC,qBAAqB;QAEjC,gCAAgC;QAChC,OAAO,OAAO,CAAC,CAAC,OAAO;YACrB,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,MAAM,SAAS,CAAC,EAAE,MAAM,KAAK,EAAE,WAAW,OAAO,MAAM,KAAK;QAC7F;QAEA,OAAO;IACT;IAEA;;GAEC,GACD,SAAS,OAAO;QACd,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAA+B,CAAC,QAAQ,EAAE,IAAI;QAElF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,sJAAQ,EAAC,SAAS,IAAI,CAAC,IAAI;IACpC;IAEA;;GAEC,GACD,gBAAgB,OAAO;QACrB,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,CAAC,QAAQ,EAAE,GAAG,KAAK,CAAC;QAGtB,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,qKAAuB,EAAC,SAAS,IAAI,CAAC,IAAI;IACnD;IAEA;;;GAGC,GACD,gBAAgB,OAAO;QACrB,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,CAAC,eAAe,EAAE,WAAW;QAG/B,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,qKAAuB,EAAC,SAAS,IAAI,CAAC,IAAI;IACnD;IAEA;;;GAGC,GACD,eAAe,OAAO;QACpB,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,CAAC,eAAe,EAAE,GAAG,QAAQ,CAAC;QAGhC,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,qKAAuB,EAAC,SAAS,IAAI,CAAC,IAAI;IACnD;IAEA;;;;GAIC,GACD,aAAa,OAAO;QAClB,MAAM,eAAe;YAAE,OAAO;YAAG,QAAQ;YAAG,UAAU;QAAE,CAAC,CAAC,OAAO;QACjE,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,CAAC,kBAAkB,EAAE,cAAc;QAGrC,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,OAAO,EAAE;QACX;QAEA,OAAO,SAAS,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,8JAAgB;IAChD;IAEA;;;;GAIC,GACD,WAAW,OAAO;QAChB,MAAM,aAAa;YAAE,QAAQ;YAAG,MAAM;YAAG,MAAM;YAAG,MAAM;QAAE,CAAC,CAAC,KAAK;QACjE,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,CAAC,gBAAgB,EAAE,YAAY;QAGjC,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,OAAO,EAAE;QACX;QAEA,OAAO,SAAS,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,8JAAgB;IAChD;IAEA;;GAEC,GACD,QAAQ,OAAO;QACb,QAAQ,GAAG,CAAC,gCAAgC;QAC5C,MAAM,cAAc,IAAA,mKAAqB,EAAC;QAC1C,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,WACA;QAGF,QAAQ,GAAG,CAAC,oBAAoB,SAAS,IAAI;QAE7C,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,sJAAQ,EAAC,SAAS,IAAI,CAAC,IAAI;IACpC;IAEA;;;GAGC,GACD,oBAAoB,OAAO;QACzB,QAAQ,GAAG,CAAC,oCAAoC;QAChD,MAAM,cAAc,IAAA,2KAA6B,EAAC;QAClD,QAAQ,GAAG,CAAC,kCAAkC;QAE9C,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,yBACA;QAGF,QAAQ,GAAG,CAAC,oBAAoB,SAAS,IAAI;QAE7C,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,qKAAuB,EAAC,SAAS,IAAI,CAAC,IAAI;IACnD;IAEA;;GAEC,GACD,QAAQ,OAAO,IAAY;QACzB,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,CAAC,QAAQ,EAAE,IAAI,EACf,IAAA,mKAAqB,EAAC;QAGxB,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,sJAAQ,EAAC,SAAS,IAAI,CAAC,IAAI;IACpC;IAEA;;;GAGC,GACD,oBAAoB,OAAO,IAAY;QACrC,QAAQ,GAAG,CAAC,oCAAoC;QAChD,MAAM,cAAc,IAAA,2KAA6B,EAAC;QAClD,QAAQ,GAAG,CAAC,+BAA+B;QAE3C,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC,CAAC,QAAQ,EAAE,GAAG,cAAc,CAAC,EAC7B;QAGF,QAAQ,GAAG,CAAC,2BAA2B,SAAS,IAAI;QAEpD,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,qKAAuB,EAAC,SAAS,IAAI,CAAC,IAAI;IACnD;IAEA;;GAEC,GACD,cAAc,OAAO,IAAY;QAC/B,MAAM,eAAe,IAAA,oKAAsB,EAAC;QAC5C,MAAM,WAAW,MAAM,sJAAS,CAAC,KAAK,CACpC,CAAC,QAAQ,EAAE,GAAG,OAAO,CAAC,EACtB;YAAE,QAAQ;QAAa;QAGzB,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,sJAAQ,EAAC,SAAS,IAAI,CAAC,IAAI;IACpC;IAEA;;GAEC,GACD,QAAQ,OAAO;QACb,MAAM,WAAW,MAAM,sJAAS,CAAC,MAAM,CAAoB,CAAC,QAAQ,EAAE,IAAI;QAE1E,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,EAAE;YAC1B,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;IACF;IAEA;;GAEC,GACD,SAAS,OAAO;QACd,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,CAAC,QAAQ,EAAE,GAAG,QAAQ,CAAC;QAGzB,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,sJAAQ,EAAC,SAAS,IAAI,CAAC,IAAI;IACpC;IAEA;;GAEC,GACD,OAAO,OAAO;QACZ,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,CAAC,QAAQ,EAAE,GAAG,MAAM,CAAC;QAGvB,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,sJAAQ,EAAC,SAAS,IAAI,CAAC,IAAI;IACpC;IAEA;;GAEC,GACD,WAAW,OAAO;QAChB,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,CAAC,QAAQ,EAAE,GAAG,UAAU,CAAC;QAG3B,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,IAAA,sJAAQ,EAAC,SAAS,IAAI,CAAC,IAAI;IACpC;IAEA;;GAEC,GACD,MAAM,OAAO,IAAY;QACvB,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,CAAC,QAAQ,EAAE,GAAG,KAAK,CAAC,EACpB;YACE,YAAY,KAAK,UAAU,IAAI,EAAE;YACjC,UAAU,KAAK,QAAQ,IAAI,EAAE;YAC7B,YAAY,KAAK,UAAU,KAAK,UAAU,IAAI,KAAK,UAAU,KAAK,QAAQ,IAAI;YAC9E,eAAe,KAAK,aAAa,IAAI;QACvC;QAGF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,SAAS,IAAI,CAAC,IAAI;IAC3B;IAEA;;GAEC,GACD,cAAc,OAAO,IAAY;QAC/B,MAAM,WAAW,MAAM,sJAAS,CAAC,IAAI,CACnC,CAAC,QAAQ,EAAE,GAAG,cAAc,CAAC,EAC7B;YAAE;QAAW;QAGf,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,MAAM,IAAI,MAAM,SAAS,IAAI,CAAC,OAAO,IAAI;QAC3C;QAEA,OAAO,SAAS,IAAI,CAAC,IAAI;IAC3B;IAEA;;GAEC,GACD,gBAAgB,OACd;QAaA,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAalC,CAAC,QAAQ,EAAE,GAAG,aAAa,CAAC;QAE9B,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;YACjD,OAAO,EAAE;QACX;QAEA,OAAO,SAAS,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAS,CAAC;gBACvC,GAAG,IAAI;gBACP,UAAU,KAAK,QAAQ,IAAI;gBAC3B,aAAa,KAAK,WAAW,IAAI;YACnC,CAAC;IACH;IAEA;;GAEC,GACD,oBAAoB,OAAO;QACzB,IAAI;YACF,MAAM,sJAAS,CAAC,IAAI,CAAC,CAAC,eAAe,EAAE,QAAQ,KAAK,CAAC;QACvD,EAAE,OAAO,OAAO;YACd,oDAAoD;YACpD,QAAQ,IAAI,CAAC,mCAAmC;QAClD;IACF;IAEA;;GAEC,GACD,mBAAmB;QACjB,IAAI;YACF,MAAM,WAAW,MAAM,sJAAS,CAAC,GAAG,CAClC;YAGF,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,EAAE;gBACjD,OAAO;YACT;YAEA,OAAO,SAAS,IAAI,CAAC,IAAI;QAC3B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,oCAAoC;YAClD,OAAO;QACT;IACF;AACF;uCAEe","debugId":null}},
    {"offset": {"line": 1477, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\n/**\n * تحويل تاريخ من Backend إلى Date object\n * الـ Backend يُرسل DateTime بتوقيت UTC لكن بدون \"Z\" suffix\n * هذه الدالة تضيف \"Z\" إذا لم تكن موجودة لضمان التحويل الصحيح\n */\nexport function parseBackendDate(dateString: string): Date {\n  if (!dateString) return new Date();\n  // إذا كان التاريخ بدون timezone indicator، نفترض أنه UTC\n  const normalized = dateString.endsWith(\"Z\") ? dateString : dateString + \"Z\";\n  return new Date(normalized);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,2LAAO,EAAC,IAAA,kKAAI,EAAC;AACtB;AAOO,SAAS,iBAAiB,UAAkB;IACjD,IAAI,CAAC,YAAY,OAAO,IAAI;IAC5B,yDAAyD;IACzD,MAAM,aAAa,WAAW,QAAQ,CAAC,OAAO,aAAa,aAAa;IACxE,OAAO,IAAI,KAAK;AAClB","debugId":null}},
    {"offset": {"line": 1503, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/pdf-export.ts"],"sourcesContent":["\"use client\";\n\nimport jsPDF from \"jspdf\";\nimport html2canvas from \"html2canvas\";\nimport { PDFEditorSettings, CustomTextOverlay } from \"@/types/pdf-editor\";\n\n// Type definitions for responses and components \ninterface Participant {\n  name?: string;\n  email?: string;\n  phone?: string;\n}\n\ninterface SignatureAnswer {\n  signatureData?: string;\n}\n\ninterface Answer {\n  componentId: string;\n  answer: unknown | SignatureAnswer;\n  signatureData?: string;\n}\n\ninterface Response {\n  id: string;\n  participant?: Participant;\n  answers: Answer[];\n  submittedAt?: string;\n  completedAt?: string;\n}\n\ninterface ComponentSettings {\n  label?: string;\n  questionType?: string;\n  maxRating?: number;\n  minValue?: number;\n  maxValue?: number;\n  headerColor?: string;\n  fontSize?: number;\n  includeSerialNumber?: boolean;\n  showHeader?: boolean;\n  showTitle?: boolean;\n}\n\ninterface Component {\n  id: string;\n  type: string;\n  settings?: ComponentSettings;\n}\n\n// Custom Table Interface\nexport interface CustomTable {\n  id: string;\n  title: string;\n  componentIds: string[];\n  order: number;\n  settings: {\n    headerColor?: string;\n    fontSize?: number;\n    includeSerialNumber?: boolean;\n    showHeader?: boolean;\n    showTitle?: boolean;\n  };\n}\n\n// PDF Export Configuration Interface\nexport interface PDFExportConfig {\n  // Layout\n  layout: \"single-table\" | \"separate-tables\" | \"custom-tables\";\n\n  // Colors\n  backgroundColor: string;\n  backgroundImage?: string; // Base64 image data for background\n  headerColor: string;\n  textColor: string;\n\n  // Font\n  fontSize: number;\n  fontFamily: string;\n\n  // Logo\n  logo?: {\n    data: string;\n    position: \"top-right\" | \"top-left\" | \"center\";\n    size: \"small\" | \"medium\" | \"large\";\n  };\n\n  // Content\n  includeParticipantName: boolean;\n  includeParticipationDate: boolean;\n  includeTextAnswers: boolean;\n  includeChoices: boolean;\n  includeRatings: boolean;\n\n  // Additional Info\n  includeEventTitle: boolean;\n  includeExportDate: boolean;\n  includeParticipantCount: boolean;\n  customFooter?: string;\n\n  // Component Selection (for single-table and separate-tables)\n  selectedComponentIds?: string[]; // Array of component IDs to include (undefined = all)\n  includeSerialNumber?: boolean; // Add serial number column\n\n  // NEW: Custom Tables\n  customTables?: CustomTable[];\n  useCustomTables?: boolean; // Enable/disable custom tables mode\n}\n\n// Default configuration\nexport const defaultPDFConfig: PDFExportConfig = {\n  layout: \"single-table\",\n  backgroundColor: \"#ffffff\",\n  backgroundImage: undefined,\n  headerColor: \"#1a56db\",\n  textColor: \"#1f2937\",\n  fontSize: 10,\n  fontFamily: \"Arial\",\n  includeParticipantName: true,\n  includeParticipationDate: true,\n  includeTextAnswers: true,\n  includeChoices: true,\n  includeRatings: true,\n  includeEventTitle: true,\n  includeExportDate: true,\n  includeParticipantCount: true,\n  selectedComponentIds: undefined, // undefined = all components\n  includeSerialNumber: false,\n  customTables: [],\n  useCustomTables: false,\n};\n\n// Helper function to format answer based on type\nexport const formatAnswer = (answer: Answer, component: Component, config: PDFExportConfig): string => {\n  const questionType = component.settings?.questionType || component.type;\n  \n  // Skip file uploads (images, PDFs, videos)\n  if ([\"pdf_upload\", \"image_upload\", \"video_upload\"].includes(component.type)) {\n    return \"[ملف مرفق - غير مضمن في PDF]\";\n  }\n  \n  // Handle signature separately (will be added as image)\n  if (component.type === \"signature\") {\n    return \"[توقيع - انظر الصورة]\";\n  }\n  \n  // Text answers\n  if (config.includeTextAnswers && \n      [\"short_text\", \"long_text\", \"email\", \"phone\", \"number\", \"url\"].includes(questionType)) {\n    return String(answer.answer || \"لا توجد إجابة\");\n  }\n  \n  // Choices\n  if (config.includeChoices) {\n    if (questionType === \"single_choice\" || questionType === \"yes_no\" || questionType === \"dropdown\") {\n      return String(answer.answer || \"لا توجد إجابة\");\n    }\n    \n    if (questionType === \"multiple_choice\") {\n      const choices = Array.isArray(answer.answer) ? answer.answer : [answer.answer];\n      return choices.join(\"، \") || \"لا توجد إجابة\";\n    }\n  }\n  \n  // Ratings\n  if (config.includeRatings && component.type === \"rating\") {\n    const rating = answer.answer || 0;\n    const maxRating = component.settings?.maxRating || 5;\n    return `${rating}/${maxRating}`;\n  }\n  \n  // Date and Time\n  if (questionType === \"date\" || questionType === \"time\") {\n    return String(answer.answer || \"لا توجد إجابة\");\n  }\n  \n  // Linear Scale\n  if (questionType === \"linear_scale\") {\n    const value = answer.answer || 0;\n    const min = component.settings?.minValue || 1;\n    const max = component.settings?.maxValue || 10;\n    return `${value} (من ${min} إلى ${max})`;\n  }\n  \n  // Table\n  if (component.type === \"table\") {\n    return \"[بيانات جدول - غير مضمن]\";\n  }\n  \n  return String(answer.answer || \"لا توجد إجابة\");\n};\n\n/**\n * Helper function to add custom text overlays to a container\n * v3.0: Custom Text Overlay feature (Phase 6)\n *\n * @param container - The HTML container element\n * @param overlays - Array of custom text overlays\n * @param fontFamily - Default font family from settings\n */\nconst addCustomTextOverlays = (\n  container: HTMLElement,\n  overlays: CustomTextOverlay[] | undefined,\n  fontFamily: string\n): void => {\n  if (!overlays || overlays.length === 0) {\n    return;\n  }\n\n  // Filter visible overlays\n  const visibleOverlays = overlays.filter(overlay => overlay.visible !== false);\n\n  if (visibleOverlays.length === 0) {\n    return;\n  }\n\n  // Sort by zIndex (lower first, so higher zIndex appears on top)\n  const sortedOverlays = [...visibleOverlays].sort((a, b) =>\n    (a.zIndex || 0) - (b.zIndex || 0)\n  );\n\n  sortedOverlays.forEach(overlay => {\n    const overlayDiv = document.createElement('div');\n\n    // Convert mm to pixels (assuming 96 DPI: 1mm ≈ 3.7795px)\n    const mmToPx = 3.7795;\n    const xPx = overlay.position.x * mmToPx;\n    const yPx = overlay.position.y * mmToPx;\n\n    // Apply styles\n    overlayDiv.style.position = 'absolute';\n    overlayDiv.style.left = `${xPx}px`;\n    overlayDiv.style.top = `${yPx}px`;\n    overlayDiv.style.fontSize = `${overlay.fontSize}px`;\n    overlayDiv.style.color = overlay.color;\n    overlayDiv.style.fontWeight = overlay.fontWeight.toString();\n    overlayDiv.style.textAlign = overlay.textAlign;\n    overlayDiv.style.fontFamily = overlay.fontFamily || fontFamily;\n    overlayDiv.style.direction = 'rtl';\n    overlayDiv.style.unicodeBidi = 'embed';\n    overlayDiv.style.whiteSpace = 'pre-wrap';\n    overlayDiv.style.lineHeight = '1.6';\n    overlayDiv.style.zIndex = (overlay.zIndex || 0).toString();\n\n    // v9.1: Arabic text rendering fixes\n    overlayDiv.style.setProperty('text-rendering', 'optimizeLegibility');\n    overlayDiv.style.setProperty('-webkit-font-smoothing', 'antialiased');\n    overlayDiv.style.setProperty('-moz-osx-font-smoothing', 'grayscale');\n\n    // Optional properties\n    if (overlay.rotation) {\n      overlayDiv.style.transform = `rotate(${overlay.rotation}deg)`;\n      overlayDiv.style.transformOrigin = 'top right';\n    }\n\n    if (overlay.opacity !== undefined) {\n      overlayDiv.style.opacity = overlay.opacity.toString();\n    }\n\n    if (overlay.backgroundColor) {\n      overlayDiv.style.backgroundColor = overlay.backgroundColor;\n      overlayDiv.style.padding = '8px 12px';\n      overlayDiv.style.borderRadius = '4px';\n    }\n\n    // Set content\n    overlayDiv.textContent = overlay.content;\n\n    // Append to container\n    container.appendChild(overlayDiv);\n  });\n};\n\n// Export to PDF - Single Table Layout (with Arabic support using HTML2Canvas)\nexport const exportSingleTablePDF = async (\n  eventTitle: string,\n  responses: Response[],\n  components: Component[],\n  config: PDFExportConfig\n) => {\n  // Create temporary container for HTML rendering\n  const container = document.createElement(\"div\");\n  container.style.position = \"absolute\";\n  container.style.left = \"-9999px\";\n  container.style.top = \"0\";\n  container.style.width = \"2000px\"; // Increased width for better table layout\n  container.style.padding = \"30px\";\n  container.style.fontFamily = \"Arial, sans-serif\";\n  container.style.direction = \"rtl\";\n  container.style.backgroundColor = config.backgroundColor;\n\n  // Build HTML content\n  let htmlContent = \"\";\n\n  // If background image is used, create a wrapper with background\n  if (config.backgroundImage) {\n    htmlContent += `\n      <div style=\"\n        background-image: url(${config.backgroundImage});\n        background-size: cover;\n        background-position: center;\n        background-repeat: no-repeat;\n        padding: 40px;\n        min-height: 100%;\n      \">\n        <div style=\"\n          background-color: rgba(255, 255, 255, 0.96);\n          padding: 40px;\n          border-radius: 16px;\n          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);\n        \">\n    `;\n  }\n\n  // Add logo if provided\n  if (config.logo) {\n    const logoSize = config.logo.size === \"small\" ? \"80px\" : config.logo.size === \"medium\" ? \"120px\" : \"160px\";\n    const logoPosition = config.logo.position === \"center\" ? \"center\" : config.logo.position === \"top-right\" ? \"flex-end\" : \"flex-start\";\n\n    htmlContent += `\n      <div style=\"display: flex; justify-content: ${logoPosition}; margin-bottom: 20px;\">\n        <img src=\"${config.logo.data}\" style=\"width: ${logoSize}; height: ${logoSize}; object-fit: contain;\" />\n      </div>\n    `;\n  }\n\n  // Add header section\n  htmlContent += `<div style=\"text-align: center; margin-bottom: 30px;\">`;\n\n  if (config.includeEventTitle) {\n    htmlContent += `<h1 style=\"color: ${config.headerColor}; font-size: 32px; margin-bottom: 10px; font-weight: bold;\">${eventTitle}</h1>`;\n  }\n\n  if (config.includeExportDate) {\n    const exportDate = new Date().toLocaleDateString(\"ar-EG\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\"\n    });\n    htmlContent += `<p style=\"color: ${config.textColor}; font-size: 14px; margin: 5px 0;\">تاريخ التصدير: ${exportDate}</p>`;\n  }\n\n  if (config.includeParticipantCount) {\n    htmlContent += `<p style=\"color: ${config.textColor}; font-size: 14px; margin: 5px 0;\">عدد المشاركين: ${responses.length}</p>`;\n  }\n\n  htmlContent += `</div>`;\n\n  // Prepare table data - filter by selected components if specified (including signature)\n  let questionComponents = components.filter(c => c.type === \"question\" || c.type === \"rating\" || c.type === \"signature\");\n\n  // Filter by selected component IDs if specified\n  if (config.selectedComponentIds && config.selectedComponentIds.length > 0) {\n    questionComponents = questionComponents.filter(c => config.selectedComponentIds!.includes(c.id));\n  }\n\n  // Calculate column widths dynamically\n  const baseColumns = [];\n  if (config.includeSerialNumber) baseColumns.push(\"#\");\n  if (config.includeParticipantName) baseColumns.push(\"المشارك\");\n  if (config.includeParticipationDate) baseColumns.push(\"التاريخ\");\n\n  const baseColumnWidth = baseColumns.length > 0 ? \"120px\" : \"0px\";\n  const serialColumnWidth = \"60px\";\n  const questionColumnWidth = questionComponents.length > 0 ? `${Math.max(100, 800 / questionComponents.length)}px` : \"0px\";\n\n  // Build table with optimized styling\n  htmlContent += `\n    <div style=\"overflow-x: auto; width: 100%;\">\n      <table style=\"\n        width: 100%;\n        border-collapse: collapse;\n        font-size: ${Math.max(10, config.fontSize - 2)}px;\n        table-layout: fixed;\n      \">\n        <thead>\n          <tr style=\"background-color: ${config.headerColor}; color: white;\">\n  `;\n\n  // Add serial number column header\n  if (config.includeSerialNumber) {\n    htmlContent += `\n      <th style=\"\n        padding: 8px 6px;\n        border: 1px solid #ddd;\n        text-align: center;\n        font-weight: bold;\n        width: ${serialColumnWidth};\n        min-width: 50px;\n        word-wrap: break-word;\n      \">#</th>\n    `;\n  }\n\n  // Add base column headers\n  if (config.includeParticipantName) {\n    htmlContent += `\n      <th style=\"\n        padding: 8px 6px;\n        border: 1px solid #ddd;\n        text-align: center;\n        font-weight: bold;\n        width: ${baseColumnWidth};\n        min-width: 100px;\n        word-wrap: break-word;\n      \">المشارك</th>\n    `;\n  }\n\n  if (config.includeParticipationDate) {\n    htmlContent += `\n      <th style=\"\n        padding: 8px 6px;\n        border: 1px solid #ddd;\n        text-align: center;\n        font-weight: bold;\n        width: ${baseColumnWidth};\n        min-width: 100px;\n        word-wrap: break-word;\n      \">التاريخ</th>\n    `;\n  }\n\n  // Add question headers with truncation\n  questionComponents.forEach((component) => {\n    const label = component.settings?.label || \"سؤال\";\n    const truncatedLabel = label.length > 30 ? label.substring(0, 27) + \"...\" : label;\n    htmlContent += `\n      <th style=\"\n        padding: 8px 6px;\n        border: 1px solid #ddd;\n        text-align: center;\n        font-weight: bold;\n        width: ${questionColumnWidth};\n        min-width: 80px;\n        word-wrap: break-word;\n        font-size: ${Math.max(9, config.fontSize - 3)}px;\n      \" title=\"${label}\">\n        ${truncatedLabel}\n      </th>\n    `;\n  });\n\n  htmlContent += `\n          </tr>\n        </thead>\n        <tbody>\n  `;\n\n  // Add rows with optimized styling\n  responses.forEach((response, index) => {\n    const rowBg = index % 2 === 0 ? \"#f9fafb\" : \"white\";\n    htmlContent += `<tr style=\"background-color: ${rowBg};\">`;\n\n    // Serial number\n    if (config.includeSerialNumber) {\n      htmlContent += `\n        <td style=\"\n          padding: 6px 4px;\n          border: 1px solid #ddd;\n          text-align: center;\n          color: ${config.textColor};\n          font-weight: bold;\n          word-wrap: break-word;\n        \">${index + 1}</td>\n      `;\n    }\n\n    // Participant name\n    if (config.includeParticipantName) {\n      const name = response.participant?.name || \"مشارك مجهول\";\n      htmlContent += `\n        <td style=\"\n          padding: 6px 4px;\n          border: 1px solid #ddd;\n          text-align: center;\n          color: ${config.textColor};\n          word-wrap: break-word;\n          overflow: hidden;\n        \">${name}</td>\n      `;\n    }\n\n    // Participation date\n    if (config.includeParticipationDate) {\n      const date = new Date(response.submittedAt || response.completedAt || new Date()).toLocaleDateString(\"ar-EG\", {\n        year: \"2-digit\",\n        month: \"2-digit\",\n        day: \"2-digit\"\n      });\n      htmlContent += `\n        <td style=\"\n          padding: 6px 4px;\n          border: 1px solid #ddd;\n          text-align: center;\n          color: ${config.textColor};\n          word-wrap: break-word;\n        \">${date}</td>\n      `;\n    }\n\n    // Add answers with truncation\n    questionComponents.forEach((component) => {\n      const answer = response.answers.find((a) => a.componentId === component.id);\n      let answerText = answer ? formatAnswer(answer, component, config) : \"لا توجد إجابة\";\n\n      // Truncate long answers\n      if (answerText.length > 50) {\n        answerText = answerText.substring(0, 47) + \"...\";\n      }\n\n      htmlContent += `\n        <td style=\"\n          padding: 6px 4px;\n          border: 1px solid #ddd;\n          text-align: center;\n          color: ${config.textColor};\n          word-wrap: break-word;\n          overflow: hidden;\n          font-size: ${Math.max(9, config.fontSize - 3)}px;\n        \" title=\"${answer ? formatAnswer(answer, component, config) : 'لا توجد إجابة'}\">\n          ${answerText}\n        </td>\n      `;\n    });\n\n    htmlContent += `</tr>`;\n  });\n\n  htmlContent += `\n        </tbody>\n      </table>\n    </div>\n  `;\n\n  // Add custom footer\n  if (config.customFooter) {\n    htmlContent += `\n      <div style=\"text-align: center; margin-top: 30px; color: ${config.textColor}; font-size: 12px;\">\n        ${config.customFooter}\n      </div>\n    `;\n  }\n\n  // Close wrappers if background image is used\n  if (config.backgroundImage) {\n    htmlContent += `\n        </div>\n      </div>\n    `;\n  }\n\n  container.innerHTML = htmlContent;\n  document.body.appendChild(container);\n\n  try {\n    // Convert HTML to canvas\n    const canvas = await html2canvas(container, {\n      scale: 2,\n      useCORS: true,\n      logging: false,\n      backgroundColor: null,\n    });\n\n    // Create PDF\n    const doc = new jsPDF({\n      orientation: \"landscape\",\n      unit: \"mm\",\n      format: \"a4\",\n    });\n\n    // A4 landscape dimensions in mm\n    const pageWidth = 297;\n    const pageHeight = 210;\n\n    // Calculate how the canvas fits into PDF pages\n    const imgHeight = (canvas.height * pageWidth) / canvas.width;\n\n    // Calculate number of pages needed\n    const totalPages = Math.ceil(imgHeight / pageHeight);\n\n    // Add pages to PDF\n    for (let page = 0; page < totalPages; page++) {\n      if (page > 0) {\n        doc.addPage();\n      }\n\n      // Calculate the portion of canvas for this page\n      const sourceY = (page * pageHeight * canvas.width) / pageWidth;\n      const sourceHeight = Math.min(\n        (pageHeight * canvas.width) / pageWidth,\n        canvas.height - sourceY\n      );\n\n      // Only add page if there's actual content\n      if (sourceHeight > 0) {\n        // Create temporary canvas for this page\n        const pageCanvas = document.createElement(\"canvas\");\n        pageCanvas.width = canvas.width;\n        pageCanvas.height = sourceHeight;\n        const ctx = pageCanvas.getContext(\"2d\");\n\n        if (ctx) {\n          // Draw the portion of the original canvas\n          ctx.drawImage(\n            canvas,\n            0, sourceY, canvas.width, sourceHeight,\n            0, 0, canvas.width, sourceHeight\n          );\n\n          // Convert to image and add to PDF\n          const pageImgData = pageCanvas.toDataURL(\"image/png\");\n          const pageImgHeight = (sourceHeight * pageWidth) / canvas.width;\n          doc.addImage(pageImgData, \"PNG\", 0, 0, pageWidth, pageImgHeight);\n        }\n      }\n    }\n\n    // Save PDF\n    const fileName = `${eventTitle.replace(/\\s+/g, \"-\")}-results-${new Date().toISOString().split(\"T\")[0]}.pdf`;\n    doc.save(fileName);\n  } finally {\n    // Clean up\n    document.body.removeChild(container);\n  }\n};\n\n// Export to PDF - Separate Tables Layout (with Arabic support using HTML2Canvas)\nexport const exportSeparateTablesPDF = async (\n  eventTitle: string,\n  responses: Response[],\n  components: Component[],\n  config: PDFExportConfig\n) => {\n  const doc = new jsPDF({\n    orientation: \"portrait\",\n    unit: \"mm\",\n    format: \"a4\",\n  });\n\n  for (let i = 0; i < responses.length; i++) {\n    const response = responses[i];\n\n    if (i > 0) {\n      doc.addPage();\n    }\n\n    // Create temporary container for HTML rendering\n    const container = document.createElement(\"div\");\n    container.style.position = \"absolute\";\n    container.style.left = \"-9999px\";\n    container.style.top = \"0\";\n    container.style.width = \"800px\";\n    container.style.padding = \"40px\";\n    container.style.fontFamily = \"Arial, sans-serif\";\n    container.style.direction = \"rtl\";\n    container.style.backgroundColor = config.backgroundColor;\n\n    // Build HTML content\n    let htmlContent = \"\";\n\n    // If background image is used, create a wrapper with background\n    if (config.backgroundImage) {\n      htmlContent += `\n        <div style=\"\n          background-image: url(${config.backgroundImage});\n          background-size: cover;\n          background-position: center;\n          background-repeat: no-repeat;\n          padding: 40px;\n          min-height: 100%;\n        \">\n          <div style=\"\n            background-color: rgba(255, 255, 255, 0.96);\n            padding: 40px;\n            border-radius: 16px;\n            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);\n          \">\n      `;\n    }\n\n    // Add logo if provided\n    if (config.logo) {\n      const logoSize = config.logo.size === \"small\" ? \"60px\" : config.logo.size === \"medium\" ? \"90px\" : \"120px\";\n      const logoPosition = config.logo.position === \"center\" ? \"center\" : config.logo.position === \"top-right\" ? \"flex-end\" : \"flex-start\";\n\n      htmlContent += `\n        <div style=\"display: flex; justify-content: ${logoPosition}; margin-bottom: 20px;\">\n          <img src=\"${config.logo.data}\" style=\"width: ${logoSize}; height: ${logoSize}; object-fit: contain;\" />\n        </div>\n      `;\n    }\n\n    // Add event title\n    if (config.includeEventTitle) {\n      htmlContent += `\n        <h1 style=\"color: ${config.headerColor}; font-size: 28px; text-align: center; margin-bottom: 20px; font-weight: bold;\">\n          ${eventTitle}\n        </h1>\n      `;\n    }\n\n    // Add participant info\n    if (config.includeParticipantName) {\n      htmlContent += `\n        <div style=\"background-color: #f3f4f6; padding: 15px; border-radius: 8px; margin-bottom: 20px;\">\n          <p style=\"color: ${config.textColor}; font-size: 16px; margin: 5px 0; font-weight: bold;\">\n            المشارك: ${response.participant?.name || \"مشارك مجهول\"}\n          </p>\n      `;\n\n      if (config.includeParticipationDate) {\n        const date = new Date(response.submittedAt || response.completedAt || new Date()).toLocaleDateString(\"ar-EG\", {\n          year: \"numeric\",\n          month: \"long\",\n          day: \"numeric\"\n        });\n        htmlContent += `\n          <p style=\"color: ${config.textColor}; font-size: 14px; margin: 5px 0;\">\n            تاريخ المشاركة: ${date}\n          </p>\n        `;\n      }\n\n      htmlContent += `</div>`;\n    }\n\n    // Build table\n    htmlContent += `\n      <table style=\"width: 100%; border-collapse: collapse; font-size: ${config.fontSize}px;\">\n        <tbody>\n    `;\n\n    // Filter components by selected IDs if specified (including signature)\n    let filteredComponents = components.filter(c => c.type === \"question\" || c.type === \"rating\" || c.type === \"signature\");\n    if (config.selectedComponentIds && config.selectedComponentIds.length > 0) {\n      filteredComponents = filteredComponents.filter(c => config.selectedComponentIds!.includes(c.id));\n    }\n\n    // Add rows\n    filteredComponents.forEach((component, index) => {\n      const answer = response.answers.find((a) => a.componentId === component.id);\n      const questionLabel = component.settings?.label || \"سؤال\";\n      const rowBg = index % 2 === 0 ? \"#f9fafb\" : \"white\";\n\n      // Handle signature specially - display as image\n      let answerContent = \"\";\n      if (component.type === \"signature\") {\n        answerContent = '<span style=\"color: #94a3b8; font-style: italic;\">لا يوجد توقيع</span>';\n        if (answer && typeof answer.answer === 'object' && answer.answer !== null) {\n          const signatureAnswer = answer.answer as SignatureAnswer;\n          const signatureData = signatureAnswer.signatureData;\n          if (signatureData) {\n            answerContent = `<img src=\"${signatureData}\" style=\"max-width: 200px; max-height: 80px;\" />`;\n          }\n        }\n      } else {\n        answerContent = answer ? formatAnswer(answer, component, config) : \"لا توجد إجابة\";\n      }\n\n      htmlContent += `\n        <tr style=\"background-color: ${rowBg};\">\n          <td style=\"padding: 12px; border: 1px solid #ddd; font-weight: bold; color: ${config.textColor}; width: 40%;\">\n            ${questionLabel}\n          </td>\n          <td style=\"padding: 12px; border: 1px solid #ddd; color: ${config.textColor}; width: 60%;\">\n            ${answerContent}\n          </td>\n        </tr>\n      `;\n    });\n\n    htmlContent += `\n        </tbody>\n      </table>\n    `;\n\n    // Add custom footer\n    if (config.customFooter && i === responses.length - 1) {\n      htmlContent += `\n        <div style=\"text-align: center; margin-top: 30px; color: ${config.textColor}; font-size: 12px;\">\n          ${config.customFooter}\n        </div>\n      `;\n    }\n\n    // Close wrappers if background image is used\n    if (config.backgroundImage) {\n      htmlContent += `\n          </div>\n        </div>\n      `;\n    }\n\n    container.innerHTML = htmlContent;\n    document.body.appendChild(container);\n\n    try {\n      // Convert HTML to canvas\n      const canvas = await html2canvas(container, {\n        scale: 2,\n        useCORS: true,\n        logging: false,\n        backgroundColor: null,\n      });\n\n      // A4 portrait dimensions in mm\n      const pageWidth = 210;\n      const pageHeight = 297;\n\n      // Calculate how the canvas fits into PDF pages\n      const imgHeight = (canvas.height * pageWidth) / canvas.width;\n\n      // Calculate number of pages needed for this participant\n      const totalPages = Math.ceil(imgHeight / pageHeight);\n\n      // Add pages to PDF\n      for (let page = 0; page < totalPages; page++) {\n        if (page > 0) {\n          doc.addPage();\n        }\n\n        // Calculate the portion of canvas for this page\n        const sourceY = (page * pageHeight * canvas.width) / pageWidth;\n        const sourceHeight = Math.min(\n          (pageHeight * canvas.width) / pageWidth,\n          canvas.height - sourceY\n        );\n\n        // Only add page if there's actual content\n        if (sourceHeight > 0) {\n          // Create temporary canvas for this page\n          const pageCanvas = document.createElement(\"canvas\");\n          pageCanvas.width = canvas.width;\n          pageCanvas.height = sourceHeight;\n          const ctx = pageCanvas.getContext(\"2d\");\n\n          if (ctx) {\n            // Draw the portion of the original canvas\n            ctx.drawImage(\n              canvas,\n              0, sourceY, canvas.width, sourceHeight,\n              0, 0, canvas.width, sourceHeight\n            );\n\n            // Convert to image and add to PDF\n            const pageImgData = pageCanvas.toDataURL(\"image/png\");\n            const pageImgHeight = (sourceHeight * pageWidth) / canvas.width;\n            doc.addImage(pageImgData, \"PNG\", 0, 0, pageWidth, pageImgHeight);\n          }\n        }\n      }\n    } finally {\n      // Clean up\n      document.body.removeChild(container);\n    }\n  }\n\n  // Save PDF\n  const fileName = `${eventTitle.replace(/\\s+/g, \"-\")}-results-${new Date().toISOString().split(\"T\")[0]}.pdf`;\n  doc.save(fileName);\n};\n\n/**\n * Export PDF with Custom Multiple Tables\n * Each table can have different components and settings\n * Uses HTML2Canvas for perfect Arabic text rendering\n * v8.0: Advanced PDF Editor integration with full customization\n */\nexport const exportCustomTablesPDF = async (\n  eventTitle: string,\n  responses: Response[],\n  components: Component[],\n  config: PDFExportConfig,\n  editorSettings?: PDFEditorSettings // Optional: Advanced editor settings\n) => {\n  // Validate custom tables\n  if (!config.customTables || config.customTables.length === 0) {\n    throw new Error(\"لا توجد جداول مخصصة للتصدير\");\n  }\n\n  // Sort tables by order\n  const sortedTables = [...config.customTables].sort((a, b) => a.order - b.order);\n\n  // Filter out empty tables\n  const validTables = sortedTables.filter(table => table.componentIds.length > 0);\n\n  if (validTables.length === 0) {\n    throw new Error(\"جميع الجداول فارغة. يرجى إضافة مكونات إلى الجداول\");\n  }\n\n  // Use editor settings if provided, otherwise use defaults\n  const orientation = editorSettings?.page.orientation || \"landscape\";\n  const format = editorSettings?.page.size || \"a4\";\n\n  const doc = new jsPDF({\n    orientation: orientation as \"landscape\" | \"portrait\",\n    unit: \"mm\",\n    format: format as \"a4\" | \"a3\" | \"letter\",\n  });\n\n  const pageWidth = doc.internal.pageSize.getWidth();\n  const pageHeight = doc.internal.pageSize.getHeight();\n\n  // Track current Y position for continuous layout\n  // Use editor settings for margins if provided\n  const topMargin = editorSettings?.page.margins.top || 5;\n  let currentY = topMargin; // Start with top margin\n  let isFirstTable = true;\n\n  // Process each table\n  for (let tableIndex = 0; tableIndex < validTables.length; tableIndex++) {\n    const table = validTables[tableIndex];\n\n    // No automatic page breaks - we'll handle them intelligently based on content height\n\n    // Filter components for this table (including signature)\n    const tableComponents = components.filter(c =>\n      table.componentIds.includes(c.id) && (c.type === \"question\" || c.type === \"rating\" || c.type === \"signature\")\n    );\n\n    // Sort components by the order in table.componentIds\n    tableComponents.sort((a, b) => {\n      const indexA = table.componentIds.indexOf(a.id);\n      const indexB = table.componentIds.indexOf(b.id);\n      return indexA - indexB;\n    });\n\n    // Get font size multiplier from config (default 1.0)\n    const fontSizeMultiplier = config.fontSize ? config.fontSize / 10 : 1.0;\n\n    // Calculate font sizes - v8.0: Use editor settings if provided, otherwise use v7.5 defaults\n    const eventTitleSize = editorSettings?.fonts.sizes.eventTitle || Math.round(58 * fontSizeMultiplier);\n    const tableTitleSize = editorSettings?.fonts.sizes.tableTitle || Math.round(48 * fontSizeMultiplier);\n    const headerSize = editorSettings?.fonts.sizes.header || Math.round(26 * fontSizeMultiplier);\n    const contentSize = editorSettings?.fonts.sizes.content || Math.round(24 * fontSizeMultiplier);\n    const infoSize = editorSettings?.fonts.sizes.info || Math.round(20 * fontSizeMultiplier);\n    const footerSize = editorSettings?.fonts.sizes.footer || Math.round(18 * fontSizeMultiplier);\n\n    // Font weights from editor settings\n    const eventTitleWeight = editorSettings?.fonts.weights.eventTitle || 900;\n    const tableTitleWeight = editorSettings?.fonts.weights.tableTitle || 900;\n    const headerWeight = editorSettings?.fonts.weights.header || 800;\n    const contentWeight = editorSettings?.fonts.weights.content || 400;\n\n    // Font family from editor settings\n    // v9.1: Use Arabic-friendly fonts\n    const fontFamily = editorSettings?.fonts.family || \"'Cairo', 'Amiri', 'Tahoma', 'Arial', sans-serif\";\n\n    // Create temporary container for HTML rendering with professional styling\n    // v8.0: Use editor settings for container styling\n    const container = document.createElement(\"div\");\n    container.style.position = \"fixed\";\n    container.style.left = \"-9999px\"; // Move off-screen but keep visible for html2canvas\n    container.style.top = \"0\";\n    container.style.width = \"3500px\"; // Increased from 2800px to 3500px for larger table\n    container.style.height = \"auto\";\n\n    // Use editor settings for padding\n    const containerPaddingV = editorSettings?.spacing.containerPadding.vertical || 40;\n    const containerPaddingH = editorSettings?.spacing.containerPadding.horizontal || 50;\n    container.style.padding = `${containerPaddingV}px ${containerPaddingH}px`;\n\n    container.style.fontFamily = fontFamily;\n    container.style.direction = \"rtl\";\n\n    // v9.1: Fix Arabic text rendering\n    container.style.unicodeBidi = \"embed\";\n    container.style.setProperty('text-rendering', 'optimizeLegibility');\n    container.style.setProperty('-webkit-font-smoothing', 'antialiased');\n    container.style.setProperty('-moz-osx-font-smoothing', 'grayscale');\n\n    // Use editor settings for background color\n    const backgroundColor = editorSettings?.page.backgroundColor || \"#ffffff\";\n    container.style.backgroundColor = backgroundColor;\n\n    container.style.zIndex = \"-9999\"; // Hide behind everything\n    // Don't use visibility:hidden - it prevents html2canvas from capturing\n    container.style.pointerEvents = \"none\"; // Disable interactions\n\n    // Build HTML content with professional styling\n    let htmlContent = \"\";\n\n    // Add logo if configured (only on first table)\n    if (config.logo && tableIndex === 0) {\n      const logoSize = config.logo.size === \"small\" ? \"70px\" : config.logo.size === \"large\" ? \"140px\" : \"100px\";\n      const logoPosition = config.logo.position === \"top-right\" ? \"flex-end\" :\n                          config.logo.position === \"top-left\" ? \"flex-start\" : \"center\";\n\n      htmlContent += `\n        <div style=\"display: flex; justify-content: ${logoPosition}; margin-bottom: 20px;\">\n          <img src=\"${config.logo.data}\" style=\"width: ${logoSize}; height: ${logoSize}; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);\" />\n        </div>\n      `;\n    }\n\n    // Add event title if configured (only on first table)\n    // v10.0: Professional design with customizable colors\n    if (config.includeEventTitle && tableIndex === 0) {\n      // v11.0: Increased margin from 80px to 100px for better spacing\n      const eventTitleMargin = editorSettings?.spacing.titleMargins.eventTitle || 100;\n      const eventTitleColor = editorSettings?.colors.eventTitleText || '#ffffff';\n      const eventTitleBg = editorSettings?.colors.eventTitleBg || 'linear-gradient(135deg, #1e293b 0%, #334155 100%)';\n\n      htmlContent += `\n        <div style=\"\n          text-align: center;\n          margin-bottom: ${eventTitleMargin}px;\n          padding: 48px 60px;\n          background: ${eventTitleBg};\n          border: none;\n          border-radius: 16px;\n          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08);\n          position: relative;\n          overflow: hidden;\n        \">\n          <div style=\"\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            height: 4px;\n            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%);\n          \"></div>\n          <h1 style=\"\n            font-size: ${eventTitleSize}px;\n            font-weight: ${eventTitleWeight};\n            color: ${eventTitleColor};\n            margin: 0;\n            font-family: ${fontFamily};\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            line-height: 1.5;\n            letter-spacing: 0;\n            text-rendering: optimizeLegibility;\n            -webkit-font-smoothing: antialiased;\n            -moz-osx-font-smoothing: grayscale;\n            white-space: pre-wrap;\n            word-break: keep-all;\n          \">${eventTitle}</h1>\n        </div>\n      `;\n    }\n\n    // Add table title with professional styling\n    // v10.0: Elegant and modern design with customizable colors\n    if (table.settings.showTitle !== false) {\n      // v11.0: Increased margin from 40px to 80px for better spacing between title and table\n      const tableTitleMargin = editorSettings?.spacing.titleMargins.tableTitle || 80;\n      // v11.0: Increased top margin from 60px to 0px (event title already has 100px bottom margin)\n      const tableTitleTopMargin = tableIndex === 0 ? '0px' : '40px';\n      const tableTitleColor = editorSettings?.colors.tableTitleText || '#1e293b';\n      const tableTitleBg = editorSettings?.colors.tableTitleBg || 'linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)';\n      const primaryColor = editorSettings?.colors.primary || '#3b82f6';\n\n      htmlContent += `\n        <div style=\"\n          text-align: right;\n          margin-bottom: ${tableTitleMargin}px;\n          margin-top: ${tableTitleTopMargin};\n          padding: 24px 36px;\n          background: ${tableTitleBg};\n          border-right: 5px solid ${primaryColor};\n          border-radius: 12px;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n        \">\n          <h2 style=\"\n            font-size: ${tableTitleSize}px;\n            font-weight: ${tableTitleWeight};\n            color: ${tableTitleColor};\n            margin: 0;\n            font-family: ${fontFamily};\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            line-height: 1.5;\n            letter-spacing: 0;\n            text-rendering: optimizeLegibility;\n            -webkit-font-smoothing: antialiased;\n            -moz-osx-font-smoothing: grayscale;\n            white-space: pre-wrap;\n            word-break: keep-all;\n          \">${table.title}</h2>\n        </div>\n      `;\n    }\n\n    // Add export info with professional styling (without emojis)\n    if ((config.includeExportDate || config.includeParticipantCount) && tableIndex === 0) {\n      let infoText = \"\";\n      if (config.includeExportDate) {\n        const exportDate = new Date().toLocaleDateString(\"ar-EG\", {\n          year: \"numeric\",\n          month: \"long\",\n          day: \"numeric\"\n        });\n        infoText += `تاريخ التصدير: ${exportDate}`;\n      }\n\n      if (config.includeParticipantCount) {\n        if (infoText) infoText += \"  |  \";\n        infoText += `عدد المشاركين: ${responses.length}`;\n      }\n\n      htmlContent += `\n        <div style=\"\n          text-align: center;\n          font-size: ${infoSize}px;\n          font-weight: 600;\n          color: #4b5563;\n          margin-bottom: 20px;\n          padding: 10px 15px;\n          background-color: #f3f4f6;\n          border: 1px solid #e5e7eb;\n          border-radius: 4px;\n          font-family: 'Arial', 'Tahoma', sans-serif;\n        \">${infoText}</div>\n      `;\n    }\n\n    // Build professional table with clean styling\n    // v8.0: Use editor settings for table styling\n\n    // v8.0: Use editor settings for cell padding (define outside if block)\n    const cellPaddingV = editorSettings?.spacing.cellPadding.vertical || 18;\n    const cellPaddingH = editorSettings?.spacing.cellPadding.horizontal || 14;\n\n    htmlContent += `\n      <table style=\"\n        width: 100%;\n        border-collapse: separate;\n        border-spacing: 0;\n        font-family: ${fontFamily};\n        direction: rtl;\n        background-color: white;\n        border: 1px solid #e2e8f0;\n        border-radius: 12px;\n        overflow: hidden;\n        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);\n      \">\n    `;\n\n    // Table header with clean professional styling\n    // v9.0: Modern gradient header design\n    // v10.0: Use editor settings for colors\n    const headerBgColor = editorSettings?.colors.headerBg || 'linear-gradient(135deg, #334155 0%, #475569 100%)';\n    const headerTextColor = editorSettings?.colors.headerText || '#ffffff';\n\n    if (table.settings.showHeader !== false) {\n      htmlContent += `<thead><tr style=\"background: ${headerBgColor};\">`;\n\n      // Serial number column\n      if (table.settings.includeSerialNumber) {\n        htmlContent += `\n          <th style=\"\n            padding: ${cellPaddingV + 4}px ${cellPaddingH}px;\n            border: none;\n            border-bottom: 2px solid rgba(255, 255, 255, 0.2);\n            text-align: center;\n            color: ${headerTextColor};\n            font-weight: ${headerWeight};\n            font-size: ${headerSize}px;\n            min-width: 80px;\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            letter-spacing: 0;\n            text-rendering: optimizeLegibility;\n            -webkit-font-smoothing: antialiased;\n            white-space: nowrap;\n          \">#</th>\n        `;\n      }\n\n      // Participant name column\n      if (config.includeParticipantName) {\n        htmlContent += `\n          <th style=\"\n            padding: ${cellPaddingV + 4}px ${cellPaddingH}px;\n            border: none;\n            border-bottom: 2px solid rgba(255, 255, 255, 0.2);\n            text-align: center;\n            color: ${headerTextColor};\n            font-weight: ${headerWeight};\n            font-size: ${headerSize}px;\n            min-width: 220px;\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            letter-spacing: 0;\n            text-rendering: optimizeLegibility;\n            -webkit-font-smoothing: antialiased;\n            white-space: nowrap;\n          \">اسم المشارك</th>\n        `;\n      }\n\n      // Participation date column\n      if (config.includeParticipationDate) {\n        htmlContent += `\n          <th style=\"\n            padding: ${cellPaddingV + 4}px ${cellPaddingH}px;\n            border: none;\n            border-bottom: 2px solid rgba(255, 255, 255, 0.2);\n            text-align: center;\n            color: ${headerTextColor};\n            font-weight: ${headerWeight};\n            font-size: ${headerSize}px;\n            min-width: 180px;\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            letter-spacing: 0;\n            text-rendering: optimizeLegibility;\n            -webkit-font-smoothing: antialiased;\n            white-space: nowrap;\n          \">التاريخ</th>\n        `;\n      }\n\n      // Component columns\n      tableComponents.forEach((component) => {\n        const label = component.settings?.label || \"سؤال\";\n        htmlContent += `\n          <th style=\"\n            padding: ${cellPaddingV + 4}px ${cellPaddingH}px;\n            border: none;\n            border-bottom: 2px solid rgba(255, 255, 255, 0.2);\n            text-align: center;\n            color: ${headerTextColor};\n            font-weight: ${headerWeight};\n            font-size: ${headerSize}px;\n            min-width: 220px;\n            max-width: 400px;\n            word-wrap: break-word;\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            letter-spacing: 0;\n            text-rendering: optimizeLegibility;\n            -webkit-font-smoothing: antialiased;\n            white-space: pre-wrap;\n          \">${label}</th>\n        `;\n      });\n\n      htmlContent += `</tr></thead>`;\n    }\n\n    // Table body with clean styling\n    // v9.0: Modern alternating row colors with subtle styling\n    htmlContent += `<tbody>`;\n\n    const textColor = editorSettings?.colors.text || \"#1e293b\";\n    const alternateRowBg = editorSettings?.colors.alternateRowBg || \"#f8fafc\";\n    const zebraStriping = editorSettings?.table.zebraStriping !== undefined\n      ? editorSettings.table.zebraStriping\n      : true;\n\n    responses.forEach((response, index) => {\n      const rowBg = (zebraStriping && index % 2 === 1) ? alternateRowBg : \"#ffffff\";\n      htmlContent += `<tr style=\"background-color: ${rowBg}; transition: background-color 0.2s;\">`;\n\n      // Serial number\n      if (table.settings.includeSerialNumber) {\n        htmlContent += `\n          <td style=\"\n            padding: ${cellPaddingV}px ${cellPaddingH}px;\n            border: none;\n            border-bottom: 1px solid #e2e8f0;\n            text-align: center;\n            color: #64748b;\n            font-size: ${contentSize}px;\n            font-weight: 600;\n            line-height: 1.6;\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            text-rendering: optimizeLegibility;\n            white-space: nowrap;\n          \">${index + 1}</td>\n        `;\n      }\n\n      // Participant name\n      if (config.includeParticipantName) {\n        const name = response.participant?.name || \"مشارك مجهول\";\n        htmlContent += `\n          <td style=\"\n            padding: ${cellPaddingV}px ${cellPaddingH}px;\n            border: none;\n            border-bottom: 1px solid #e2e8f0;\n            text-align: center;\n            color: ${textColor};\n            font-size: ${contentSize}px;\n            font-weight: ${contentWeight};\n            line-height: 1.6;\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            text-rendering: optimizeLegibility;\n            white-space: pre-wrap;\n          \">${name}</td>\n        `;\n      }\n\n      // Participation date\n      if (config.includeParticipationDate) {\n        const date = new Date(response.submittedAt || response.completedAt || new Date()).toLocaleDateString(\"ar-EG\", {\n          year: \"numeric\",\n          month: \"2-digit\",\n          day: \"2-digit\"\n        });\n        htmlContent += `\n          <td style=\"\n            padding: ${cellPaddingV}px ${cellPaddingH}px;\n            border: none;\n            border-bottom: 1px solid #e2e8f0;\n            text-align: center;\n            color: #64748b;\n            font-size: ${contentSize}px;\n            font-weight: 500;\n            line-height: 1.6;\n            direction: rtl;\n            unicode-bidi: bidi-override;\n            text-rendering: optimizeLegibility;\n            white-space: nowrap;\n          \">${date}</td>\n        `;\n      }\n\n      // Component answers\n      tableComponents.forEach((component) => {\n        const answer = response.answers.find((a) => a.componentId === component.id);\n\n        // Handle signature component specially - display as image\n        if (component.type === \"signature\") {\n          let signatureContent = '<span style=\"color: #94a3b8; font-style: italic;\">لا يوجد توقيع</span>';\n\n          if (answer && typeof answer.answer === 'object' && answer.answer !== null) {\n            const signatureAnswer = answer.answer as SignatureAnswer;\n            const signatureData = signatureAnswer.signatureData;\n            if (signatureData) {\n              signatureContent = `<img src=\"${signatureData}\" style=\"max-width: 120px; max-height: 60px; display: block; margin: 0 auto;\" />`;\n            }\n          }\n\n          htmlContent += `\n            <td style=\"\n              padding: ${cellPaddingV}px ${cellPaddingH}px;\n              border: none;\n              border-bottom: 1px solid #e2e8f0;\n              text-align: center;\n              vertical-align: middle;\n            \">${signatureContent}</td>\n          `;\n        } else {\n          // Regular components - display as text\n          const answerText = answer ? formatAnswer(answer, component, config) : \"لا توجد إجابة\";\n\n          htmlContent += `\n            <td style=\"\n              padding: ${cellPaddingV}px ${cellPaddingH}px;\n              border: none;\n              border-bottom: 1px solid #e2e8f0;\n              text-align: center;\n              color: ${answer ? textColor : '#94a3b8'};\n              font-size: ${contentSize}px;\n              font-weight: ${contentWeight};\n              word-wrap: break-word;\n              line-height: 1.6;\n              direction: rtl;\n              unicode-bidi: bidi-override;\n              text-rendering: optimizeLegibility;\n              white-space: pre-wrap;\n            \">${answerText}</td>\n          `;\n        }\n      });\n\n      htmlContent += `</tr>`;\n    });\n\n    htmlContent += `</tbody></table>`;\n\n    // Add custom footer if configured (without page numbers)\n    if (config.customFooter) {\n      htmlContent += `\n        <div style=\"\n          text-align: center;\n          margin-top: 20px;\n          padding-top: 15px;\n          border-top: 1px solid #dee2e6;\n        \">\n          <div style=\"\n            font-size: ${footerSize}px;\n            color: #868e96;\n            font-family: 'Arial', 'Tahoma', sans-serif;\n          \">${config.customFooter}</div>\n        </div>\n      `;\n    }\n\n    htmlContent += `</div>`;\n\n    container.innerHTML = htmlContent;\n    document.body.appendChild(container);\n\n    // v3.0: Add custom text overlays (Phase 6)\n    if (editorSettings?.customTextOverlays) {\n      addCustomTextOverlays(\n        container,\n        editorSettings.customTextOverlays,\n        fontFamily\n      );\n    }\n\n    // Wait a bit for rendering\n    await new Promise(resolve => setTimeout(resolve, 300));\n\n    // Calculate dimensions for PDF\n    // v8.0: Use editor settings for quality\n    const quality = editorSettings?.advanced.quality || \"high\";\n    const qualityScale = quality === \"low\" ? 1 : quality === \"medium\" ? 2 : 3;\n\n    let canvas: HTMLCanvasElement;\n    try {\n      canvas = await html2canvas(container, {\n        scale: qualityScale,\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: backgroundColor,\n        logging: false,\n        width: 3500,\n        windowWidth: 3500,\n        imageTimeout: 0,\n        removeContainer: false,\n      });\n    } catch (error) {\n      // Clean up container on error\n      if (container && container.parentNode === document.body) {\n        document.body.removeChild(container);\n      }\n      console.error(`Failed to render table ${tableIndex + 1}:`, error);\n      throw new Error(`فشل في تحويل الجدول ${tableIndex + 1} إلى صورة. ${error instanceof Error ? error.message : 'خطأ غير معروف'}`);\n    }\n\n    // Clean up container\n    if (container && container.parentNode === document.body) {\n      document.body.removeChild(container);\n    }\n\n    const imgData = canvas.toDataURL(\"image/png\", 1.0); // Maximum quality\n\n    // Use editor settings for margins\n    const leftMargin = editorSettings?.page.margins.left || 5;\n    const rightMargin = editorSettings?.page.margins.right || 5;\n    const bottomMargin = editorSettings?.page.margins.bottom || 5;\n\n    // Validate canvas dimensions\n    if (!canvas || canvas.width <= 0 || canvas.height <= 0) {\n      console.error(\"Invalid canvas dimensions:\", { width: canvas?.width, height: canvas?.height });\n      throw new Error(`فشل في إنشاء الجدول ${tableIndex + 1}. أبعاد غير صالحة.`);\n    }\n\n    const imgWidth = pageWidth - leftMargin - rightMargin;\n    const imgHeight = (canvas.height * imgWidth) / canvas.width;\n\n    // Validate calculated dimensions\n    if (!isFinite(imgWidth) || imgWidth <= 0 || !isFinite(imgHeight) || imgHeight <= 0) {\n      console.error(\"Invalid image dimensions:\", {\n        imgWidth,\n        imgHeight,\n        pageWidth,\n        leftMargin,\n        rightMargin,\n        canvasWidth: canvas.width,\n        canvasHeight: canvas.height\n      });\n      throw new Error(`فشل في حساب أبعاد الجدول ${tableIndex + 1}. قيم غير صالحة.`);\n    }\n\n    // Validate margins and currentY\n    if (!isFinite(leftMargin) || leftMargin < 0 || !isFinite(currentY) || currentY < 0) {\n      console.error(\"Invalid position values:\", { leftMargin, currentY });\n      throw new Error(`فشل في تحديد موضع الجدول ${tableIndex + 1}. قيم غير صالحة.`);\n    }\n\n    // Add spacing between tables (except for first table)\n    // v8.0: Use editor settings for table separation\n    const tableSeparation = editorSettings?.spacing.tableSeparation || 15;\n    const tableSpacing = isFirstTable ? 0 : tableSeparation;\n\n    // Check if table fits on current page\n    const availableHeight = pageHeight - currentY - bottomMargin;\n\n    if (imgHeight + tableSpacing <= availableHeight) {\n      // Table fits on current page - add it with spacing\n      currentY += tableSpacing;\n      doc.addImage(imgData, \"PNG\", leftMargin, currentY, imgWidth, imgHeight);\n      currentY += imgHeight;\n    } else {\n      // Table doesn't fit - start new page\n      doc.addPage();\n      currentY = topMargin; // Reset Y position with top margin\n      doc.addImage(imgData, \"PNG\", leftMargin, currentY, imgWidth, imgHeight);\n      currentY += imgHeight;\n    }\n\n    isFirstTable = false;\n  }\n\n  // Save PDF with professional filename\n  const fileName = `${eventTitle.replace(/\\s+/g, \"-\")}-custom-tables-${new Date().toISOString().split(\"T\")[0]}.pdf`;\n  doc.save(fileName);\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2722, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/pdf-template-validator.ts"],"sourcesContent":["/**\n * PDF Template Validator\n * \n * Validates imported PDF templates to ensure they have correct structure.\n * Prevents errors from malformed or corrupted template files.\n * \n * @version 1.0.0\n * @date 2025-11-05\n */\n\nimport { PDFEditorSettings, AVAILABLE_FONTS } from '@/types/pdf-editor';\n\n/**\n * Validation result interface\n */\nexport interface ValidationResult {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n}\n\n/**\n * Validate PDF editor settings structure\n */\nexport function validatePDFSettings(data: any): ValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // Check if data exists\n  if (!data || typeof data !== 'object') {\n    errors.push('البيانات غير صالحة أو فارغة');\n    return { isValid: false, errors, warnings };\n  }\n\n  // Validate page settings\n  if (!data.page || typeof data.page !== 'object') {\n    errors.push('إعدادات الصفحة مفقودة');\n  } else {\n    if (!['landscape', 'portrait'].includes(data.page.orientation)) {\n      errors.push('اتجاه الصفحة غير صالح');\n    }\n    if (!['a4', 'a3', 'letter', 'legal', 'custom'].includes(data.page.size)) {\n      errors.push('حجم الصفحة غير صالح');\n    }\n    if (!data.page.margins || typeof data.page.margins !== 'object') {\n      errors.push('هوامش الصفحة مفقودة');\n    } else {\n      const margins = ['top', 'right', 'bottom', 'left'];\n      margins.forEach(margin => {\n        if (typeof data.page.margins[margin] !== 'number') {\n          errors.push(`هامش ${margin} غير صالح`);\n        }\n      });\n    }\n    if (typeof data.page.backgroundColor !== 'string' || !data.page.backgroundColor.match(/^#[0-9A-Fa-f]{6}$/)) {\n      warnings.push('لون خلفية الصفحة غير صالح، سيتم استخدام القيمة الافتراضية');\n    }\n  }\n\n  // Validate fonts settings\n  if (!data.fonts || typeof data.fonts !== 'object') {\n    errors.push('إعدادات الخطوط مفقودة');\n  } else {\n    // Validate font family\n    const validFonts = AVAILABLE_FONTS.map(f => f.value);\n    if (!validFonts.includes(data.fonts.family)) {\n      warnings.push('نوع الخط غير صالح، سيتم استخدام Arial');\n    }\n\n    // Validate font sizes\n    if (!data.fonts.sizes || typeof data.fonts.sizes !== 'object') {\n      errors.push('أحجام الخطوط مفقودة');\n    } else {\n      const sizeKeys = ['eventTitle', 'tableTitle', 'header', 'content', 'info', 'footer'];\n      sizeKeys.forEach(key => {\n        if (typeof data.fonts.sizes[key] !== 'number' || data.fonts.sizes[key] < 8 || data.fonts.sizes[key] > 100) {\n          warnings.push(`حجم الخط ${key} غير صالح`);\n        }\n      });\n    }\n\n    // Validate font weights\n    if (!data.fonts.weights || typeof data.fonts.weights !== 'object') {\n      errors.push('أوزان الخطوط مفقودة');\n    } else {\n      const weightKeys = ['eventTitle', 'tableTitle', 'header', 'content'];\n      const validWeights = [100, 200, 300, 400, 500, 600, 700, 800, 900];\n      weightKeys.forEach(key => {\n        if (!validWeights.includes(data.fonts.weights[key])) {\n          warnings.push(`وزن الخط ${key} غير صالح`);\n        }\n      });\n    }\n  }\n\n  // Validate colors settings\n  if (!data.colors || typeof data.colors !== 'object') {\n    errors.push('إعدادات الألوان مفقودة');\n  } else {\n    const colorKeys = [\n      'primary', 'secondary', 'text', 'border',\n      'eventTitleBg', 'eventTitleText',\n      'tableTitleBg', 'tableTitleText',\n      'headerBg', 'headerText',\n      'alternateRowBg'\n    ];\n    colorKeys.forEach(key => {\n      if (typeof data.colors[key] !== 'string' || !data.colors[key].match(/^#[0-9A-Fa-f]{6}$/)) {\n        warnings.push(`اللون ${key} غير صالح`);\n      }\n    });\n  }\n\n  // Validate spacing settings\n  if (!data.spacing || typeof data.spacing !== 'object') {\n    errors.push('إعدادات المسافات مفقودة');\n  } else {\n    if (typeof data.spacing.tableSeparation !== 'number' || data.spacing.tableSeparation < 0) {\n      warnings.push('مسافة الفصل بين الجداول غير صالحة');\n    }\n    if (!data.spacing.containerPadding || typeof data.spacing.containerPadding !== 'object') {\n      warnings.push('حشو الحاوية مفقود');\n    }\n    if (!data.spacing.cellPadding || typeof data.spacing.cellPadding !== 'object') {\n      warnings.push('حشو الخلايا مفقود');\n    }\n    if (!data.spacing.titleMargins || typeof data.spacing.titleMargins !== 'object') {\n      warnings.push('هوامش العناوين مفقودة');\n    }\n  }\n\n  // Validate table settings\n  if (!data.table || typeof data.table !== 'object') {\n    errors.push('إعدادات الجداول مفقودة');\n  } else {\n    if (!data.table.border || typeof data.table.border !== 'object') {\n      warnings.push('إعدادات حدود الجدول مفقودة');\n    } else {\n      if (typeof data.table.border.width !== 'number' || data.table.border.width < 0 || data.table.border.width > 10) {\n        warnings.push('عرض حدود الجدول غير صالح');\n      }\n      if (!['solid', 'dashed', 'dotted'].includes(data.table.border.style)) {\n        warnings.push('نمط حدود الجدول غير صالح');\n      }\n    }\n    if (!['auto', 'fixed', 'custom'].includes(data.table.columnWidthMode)) {\n      warnings.push('وضع عرض الأعمدة غير صالح');\n    }\n    if (typeof data.table.zebraStriping !== 'boolean') {\n      warnings.push('إعداد الصفوف المتناوبة غير صالح');\n    }\n  }\n\n  // Validate advanced settings\n  if (!data.advanced || typeof data.advanced !== 'object') {\n    errors.push('الإعدادات المتقدمة مفقودة');\n  } else {\n    if (!['low', 'medium', 'high'].includes(data.advanced.quality)) {\n      warnings.push('جودة التصدير غير صالحة');\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * Sanitize and fix common issues in imported settings\n */\nexport function sanitizePDFSettings(data: any): Partial<PDFEditorSettings> {\n  const sanitized: any = { ...data };\n\n  // Fix colors - ensure they have # prefix\n  if (sanitized.colors) {\n    Object.keys(sanitized.colors).forEach(key => {\n      if (typeof sanitized.colors[key] === 'string' && !sanitized.colors[key].startsWith('#')) {\n        sanitized.colors[key] = '#' + sanitized.colors[key];\n      }\n    });\n  }\n\n  // Fix font weights - ensure they are valid numbers\n  if (sanitized.fonts?.weights) {\n    const validWeights = [100, 200, 300, 400, 500, 600, 700, 800, 900];\n    Object.keys(sanitized.fonts.weights).forEach(key => {\n      const weight = sanitized.fonts.weights[key];\n      if (!validWeights.includes(weight)) {\n        // Find closest valid weight\n        sanitized.fonts.weights[key] = validWeights.reduce((prev, curr) => \n          Math.abs(curr - weight) < Math.abs(prev - weight) ? curr : prev\n        );\n      }\n    });\n  }\n\n  // Fix page size - ensure it's lowercase\n  if (sanitized.page?.size) {\n    sanitized.page.size = sanitized.page.size.toLowerCase();\n  }\n\n  // Fix orientation - ensure it's lowercase\n  if (sanitized.page?.orientation) {\n    sanitized.page.orientation = sanitized.page.orientation.toLowerCase();\n  }\n\n  return sanitized;\n}\n\n/**\n * Create a safe filename for template export\n */\nexport function createTemplateFilename(templateName: string): string {\n  const safeName = templateName\n    .replace(/[^a-zA-Z0-9\\u0600-\\u06FF\\s-]/g, '') // Keep Arabic, English, numbers, spaces, hyphens\n    .replace(/\\s+/g, '-') // Replace spaces with hyphens\n    .toLowerCase();\n  \n  const timestamp = new Date().toISOString().split('T')[0];\n  return `pdf-template-${safeName}-${timestamp}.json`;\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2989, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/pdf-performance.ts"],"sourcesContent":["/**\n * PDF Performance Utilities\n * \n * Performance monitoring and optimization utilities for PDF editor.\n * Helps track render times, memory usage, and identify bottlenecks.\n * \n * @version 1.0.0\n * @date 2025-11-05\n */\n\n/**\n * Performance metrics interface\n */\nexport interface PerformanceMetrics {\n  renderTime: number;\n  previewGenerationTime: number;\n  settingsUpdateTime: number;\n  memoryUsage?: number;\n}\n\n/**\n * Performance monitor class\n */\nclass PerformanceMonitor {\n  private metrics: Map<string, number> = new Map();\n  private enabled: boolean = process.env.NODE_ENV === 'development';\n\n  /**\n   * Start timing an operation\n   */\n  start(label: string): void {\n    if (!this.enabled) return;\n    this.metrics.set(label, performance.now());\n  }\n\n  /**\n   * End timing an operation and log the result\n   */\n  end(label: string): number {\n    if (!this.enabled) return 0;\n    \n    const startTime = this.metrics.get(label);\n    if (!startTime) {\n      console.warn(`Performance: No start time found for \"${label}\"`);\n      return 0;\n    }\n\n    const duration = performance.now() - startTime;\n    this.metrics.delete(label);\n\n    // Log if duration is significant (> 100ms)\n    if (duration > 100) {\n      console.warn(`⚠️ Performance: \"${label}\" took ${duration.toFixed(2)}ms`);\n    } else {\n      console.log(`✓ Performance: \"${label}\" took ${duration.toFixed(2)}ms`);\n    }\n\n    return duration;\n  }\n\n  /**\n   * Measure memory usage (if available)\n   */\n  measureMemory(): number | undefined {\n    if (!this.enabled) return undefined;\n    \n    // @ts-ignore - performance.memory is not in TypeScript types\n    if (performance.memory) {\n      // @ts-ignore\n      const usedJSHeapSize = performance.memory.usedJSHeapSize;\n      // @ts-ignore\n      const totalJSHeapSize = performance.memory.totalJSHeapSize;\n      const percentage = (usedJSHeapSize / totalJSHeapSize) * 100;\n      \n      console.log(`Memory: ${(usedJSHeapSize / 1048576).toFixed(2)}MB / ${(totalJSHeapSize / 1048576).toFixed(2)}MB (${percentage.toFixed(1)}%)`);\n      \n      return usedJSHeapSize;\n    }\n    \n    return undefined;\n  }\n\n  /**\n   * Clear all metrics\n   */\n  clear(): void {\n    this.metrics.clear();\n  }\n\n  /**\n   * Enable/disable monitoring\n   */\n  setEnabled(enabled: boolean): void {\n    this.enabled = enabled;\n  }\n}\n\n// Singleton instance\nexport const performanceMonitor = new PerformanceMonitor();\n\n/**\n * Debounce function for performance optimization\n */\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout | null = null;\n\n  return function executedFunction(...args: Parameters<T>) {\n    const later = () => {\n      timeout = null;\n      func(...args);\n    };\n\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n    timeout = setTimeout(later, wait);\n  };\n}\n\n/**\n * Throttle function for performance optimization\n */\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number\n): (...args: Parameters<T>) => void {\n  let inThrottle: boolean = false;\n\n  return function executedFunction(...args: Parameters<T>) {\n    if (!inThrottle) {\n      func(...args);\n      inThrottle = true;\n      setTimeout(() => {\n        inThrottle = false;\n      }, limit);\n    }\n  };\n}\n\n/**\n * Memoize function results for performance\n */\nexport function memoize<T extends (...args: any[]) => any>(\n  func: T\n): T {\n  const cache = new Map<string, ReturnType<T>>();\n\n  return ((...args: Parameters<T>) => {\n    const key = JSON.stringify(args);\n    \n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n\n    const result = func(...args);\n    cache.set(key, result);\n\n    // Limit cache size to prevent memory leaks\n    if (cache.size > 100) {\n      const firstKey = cache.keys().next().value;\n      if (firstKey !== undefined) {\n        cache.delete(firstKey);\n      }\n    }\n\n    return result;\n  }) as T;\n}\n\n/**\n * Measure component render time\n */\nexport function measureRender(componentName: string) {\n  return {\n    onRenderStart: () => {\n      performanceMonitor.start(`render:${componentName}`);\n    },\n    onRenderEnd: () => {\n      performanceMonitor.end(`render:${componentName}`);\n    },\n  };\n}\n\n/**\n * Check if browser supports required features\n */\nexport function checkBrowserSupport(): {\n  supported: boolean;\n  missing: string[];\n} {\n  const missing: string[] = [];\n\n  // Check for required APIs\n  if (typeof window === 'undefined') {\n    return { supported: false, missing: ['window'] };\n  }\n\n  if (!window.localStorage) {\n    missing.push('localStorage');\n  }\n\n  if (!window.Blob) {\n    missing.push('Blob API');\n  }\n\n  if (!window.URL || !window.URL.createObjectURL) {\n    missing.push('URL API');\n  }\n\n  if (!window.FileReader) {\n    missing.push('FileReader API');\n  }\n\n  // Check for canvas support\n  const canvas = document.createElement('canvas');\n  if (!canvas.getContext || !canvas.getContext('2d')) {\n    missing.push('Canvas API');\n  }\n\n  return {\n    supported: missing.length === 0,\n    missing,\n  };\n}\n\n/**\n * Optimize image for better performance\n */\nexport async function optimizeImage(\n  imageUrl: string,\n  maxWidth: number = 1920,\n  quality: number = 0.9\n): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.crossOrigin = 'anonymous';\n    \n    img.onload = () => {\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      \n      if (!ctx) {\n        reject(new Error('Canvas context not available'));\n        return;\n      }\n\n      // Calculate new dimensions\n      let width = img.width;\n      let height = img.height;\n      \n      if (width > maxWidth) {\n        height = (height * maxWidth) / width;\n        width = maxWidth;\n      }\n\n      canvas.width = width;\n      canvas.height = height;\n\n      // Draw and compress\n      ctx.drawImage(img, 0, 0, width, height);\n      \n      canvas.toBlob(\n        (blob) => {\n          if (blob) {\n            resolve(URL.createObjectURL(blob));\n          } else {\n            reject(new Error('Failed to create blob'));\n          }\n        },\n        'image/jpeg',\n        quality\n      );\n    };\n\n    img.onerror = () => {\n      reject(new Error('Failed to load image'));\n    };\n\n    img.src = imageUrl;\n  });\n}\n\n/**\n * Batch updates for better performance\n */\nexport class BatchUpdater<T> {\n  private updates: T[] = [];\n  private timeout: NodeJS.Timeout | null = null;\n  private callback: (updates: T[]) => void;\n  private delay: number;\n\n  constructor(callback: (updates: T[]) => void, delay: number = 100) {\n    this.callback = callback;\n    this.delay = delay;\n  }\n\n  add(update: T): void {\n    this.updates.push(update);\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    this.timeout = setTimeout(() => {\n      this.flush();\n    }, this.delay);\n  }\n\n  flush(): void {\n    if (this.updates.length > 0) {\n      this.callback([...this.updates]);\n      this.updates = [];\n    }\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      this.timeout = null;\n    }\n  }\n\n  clear(): void {\n    this.updates = [];\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      this.timeout = null;\n    }\n  }\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3238, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/excel-export.ts"],"sourcesContent":["import * as XLSX from \"xlsx\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\n// Excel Export Configuration Interface\nexport interface ExcelExportConfig {\n  // Layout\n  layout: \"single-sheet\" | \"separate-sheets\";\n  \n  // Formatting\n  headerBackgroundColor: string;\n  headerTextColor: string;\n  evenRowColor: string;\n  oddRowColor: string;\n  borderStyle: \"none\" | \"light\" | \"medium\" | \"thick\";\n  fontSize: number;\n  \n  // Options\n  freezeHeader: boolean;\n  autoFilter: boolean;\n  autoFitColumns: boolean;\n  zebraStriping: boolean; // Alternate row colors\n  \n  // Content - Columns to include\n  includeParticipantName: boolean;\n  includeParticipantEmail: boolean;\n  includeParticipationDate: boolean;\n  includeTimeSpent: boolean;\n  includeDevice: boolean;\n  includeScore: boolean; // For quizzes only\n  includeAllQuestions: boolean;\n  \n  // Additional Info\n  includeStatisticsRow: boolean;\n  includeSummarySheet: boolean;\n  includeEventTitle: boolean;\n  includeExportDate: boolean;\n  includeParticipantCount: boolean;\n  customFooter?: string;\n}\n\n// Default configuration\nexport const defaultExcelConfig: ExcelExportConfig = {\n  layout: \"single-sheet\",\n  headerBackgroundColor: \"#1a56db\",\n  headerTextColor: \"#ffffff\",\n  evenRowColor: \"#f9fafb\",\n  oddRowColor: \"#ffffff\",\n  borderStyle: \"light\",\n  fontSize: 11,\n  freezeHeader: true,\n  autoFilter: true,\n  autoFitColumns: true,\n  zebraStriping: true,\n  includeParticipantName: true,\n  includeParticipantEmail: true,\n  includeParticipationDate: true,\n  includeTimeSpent: true,\n  includeDevice: true,\n  includeScore: true,\n  includeAllQuestions: true,\n  includeStatisticsRow: false,\n  includeSummarySheet: false,\n  includeEventTitle: true,\n  includeExportDate: true,\n  includeParticipantCount: true,\n};\n\n// Helper function to convert hex color to Excel color object\nconst hexToExcelColor = (hex: string): { rgb: string } => {\n  const cleanHex = hex.replace(\"#\", \"\");\n  return { rgb: cleanHex.toUpperCase() };\n};\n\n// Helper function to format time spent\nconst formatTimeSpent = (seconds: number): string => {\n  const hours = Math.floor(seconds / 3600);\n  const minutes = Math.floor((seconds % 3600) / 60);\n  const secs = seconds % 60;\n  \n  if (hours > 0) {\n    return `${hours}س ${minutes}د ${secs}ث`;\n  } else if (minutes > 0) {\n    return `${minutes}د ${secs}ث`;\n  } else {\n    return `${secs}ث`;\n  }\n};\n\n// Helper function to format answer\nconst formatAnswer = (answer: any, component: any): string => {\n  if (!answer || !answer.answer) return \"لا توجد إجابة\";\n\n  const answerValue = answer.answer;\n\n  // Handle different component types\n  switch (component.type) {\n    case \"question\":\n      if (component.settings.questionType === \"single_choice\" || \n          component.settings.questionType === \"multiple_choice\") {\n        if (Array.isArray(answerValue)) {\n          return answerValue.join(\", \");\n        }\n        return String(answerValue);\n      }\n      if (component.settings.questionType === \"yes_no\") {\n        return answerValue === \"yes\" ? \"نعم\" : \"لا\";\n      }\n      return String(answerValue);\n      \n    case \"rating\":\n      if (component.settings.ratingType === \"stars\") {\n        return `${\"⭐\".repeat(answerValue)} (${answerValue}/${component.settings.maxRating})`;\n      }\n      return `${answerValue}/${component.settings.maxRating}`;\n      \n    case \"signature\":\n      return answerValue.signatureData ? \"✓ تم التوقيع\" : \"لم يتم التوقيع\";\n      \n    case \"pdf_upload\":\n    case \"image_upload\":\n    case \"video_upload\":\n      return answerValue.fileName || \"تم الرفع\";\n      \n    case \"link\":\n      return answerValue.url || \"لا يوجد رابط\";\n      \n    default:\n      return String(answerValue);\n  }\n};\n\n// Export to Excel - Single Sheet Layout\nexport const exportSingleSheetExcel = (\n  eventTitle: string,\n  responses: any[],\n  components: any[],\n  config: ExcelExportConfig\n) => {\n  const workbook = XLSX.utils.book_new();\n  \n  // Prepare data array\n  const data: any[][] = [];\n  \n  // Add event info rows if enabled\n  let headerRowIndex = 0;\n  \n  if (config.includeEventTitle) {\n    data.push([eventTitle]);\n    headerRowIndex++;\n  }\n  \n  if (config.includeExportDate) {\n    data.push([`تاريخ التصدير: ${format(new Date(), \"PPP\", { locale: ar })}`]);\n    headerRowIndex++;\n  }\n  \n  if (config.includeParticipantCount) {\n    data.push([`عدد المشاركين: ${responses.length}`]);\n    headerRowIndex++;\n  }\n  \n  // Add empty row if we added info\n  if (headerRowIndex > 0) {\n    data.push([]);\n    headerRowIndex++;\n  }\n  \n  // Build header row\n  const headers: string[] = [];\n  \n  if (config.includeParticipantName) headers.push(\"اسم المشارك\");\n  if (config.includeParticipantEmail) headers.push(\"البريد الإلكتروني\");\n  if (config.includeParticipationDate) headers.push(\"تاريخ المشاركة\");\n  if (config.includeTimeSpent) headers.push(\"الوقت المستغرق\");\n  if (config.includeDevice) headers.push(\"الجهاز\");\n  if (config.includeScore) headers.push(\"النتيجة\");\n  \n  // Add question headers\n  const questionComponents = components.filter(\n    c => config.includeAllQuestions && (c.type === \"question\" || c.type === \"rating\")\n  );\n  \n  questionComponents.forEach(component => {\n    const label = component.settings?.label || \"سؤال\";\n    headers.push(label);\n  });\n  \n  data.push(headers);\n  \n  // Add data rows\n  responses.forEach(response => {\n    const row: any[] = [];\n    \n    if (config.includeParticipantName) {\n      row.push(response.participant?.name || \"مشارك مجهول\");\n    }\n    if (config.includeParticipantEmail) {\n      row.push(response.participant?.email || \"\");\n    }\n    if (config.includeParticipationDate) {\n      const date = response.completedAt || response.startedAt;\n      row.push(date ? format(new Date(date), \"PPP\", { locale: ar }) : \"\");\n    }\n    if (config.includeTimeSpent) {\n      row.push(formatTimeSpent(response.timeSpent || 0));\n    }\n    if (config.includeDevice) {\n      row.push(response.metadata?.device || \"غير معروف\");\n    }\n    if (config.includeScore && response.score) {\n      row.push(`${response.score.totalScore}/${response.score.maxScore}`);\n    }\n    \n    // Add answers\n    questionComponents.forEach(component => {\n      const answer = response.answers.find((a: any) => a.componentId === component.id);\n      row.push(formatAnswer(answer, component));\n    });\n    \n    data.push(row);\n  });\n  \n  // Add statistics row if enabled\n  if (config.includeStatisticsRow && responses.length > 0) {\n    data.push([]); // Empty row\n    const statsRow: any[] = [\"الإحصائيات\"];\n    \n    // Add empty cells for other columns\n    for (let i = 1; i < headers.length; i++) {\n      statsRow.push(\"\");\n    }\n    \n    data.push(statsRow);\n  }\n  \n  // Create worksheet\n  const worksheet = XLSX.utils.aoa_to_sheet(data);\n  \n  // Apply styling (basic - XLSX has limited styling support)\n  const range = XLSX.utils.decode_range(worksheet['!ref'] || 'A1');\n  \n  // Set column widths\n  if (config.autoFitColumns) {\n    const colWidths = headers.map((header, i) => {\n      const maxLength = Math.max(\n        header.length,\n        ...data.slice(headerRowIndex + 1).map(row => String(row[i] || \"\").length)\n      );\n      return { wch: Math.min(maxLength + 2, 50) };\n    });\n    worksheet['!cols'] = colWidths;\n  }\n  \n  // Add worksheet to workbook\n  XLSX.utils.book_append_sheet(workbook, worksheet, \"النتائج\");\n  \n  // Add summary sheet if enabled\n  if (config.includeSummarySheet) {\n    const summaryData = [\n      [\"ملخص النتائج\"],\n      [],\n      [\"عنوان الحدث\", eventTitle],\n      [\"عدد المشاركين\", responses.length],\n      [\"تاريخ التصدير\", format(new Date(), \"PPP\", { locale: ar })],\n    ];\n    \n    if (config.includeScore && responses.some(r => r.score)) {\n      const scores = responses.filter(r => r.score).map(r => r.score.totalScore);\n      const avgScore = scores.reduce((a, b) => a + b, 0) / scores.length;\n      const maxScore = Math.max(...scores);\n      const minScore = Math.min(...scores);\n      \n      summaryData.push(\n        [],\n        [\"إحصائيات النتائج\"],\n        [\"متوسط الدرجات\", avgScore.toFixed(2)],\n        [\"أعلى درجة\", maxScore],\n        [\"أقل درجة\", minScore]\n      );\n    }\n    \n    const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);\n    XLSX.utils.book_append_sheet(workbook, summarySheet, \"الملخص\");\n  }\n  \n  // Generate file and download\n  const fileName = `${eventTitle.replace(/\\s+/g, \"-\")}-results-${new Date().toISOString().split(\"T\")[0]}.xlsx`;\n  XLSX.writeFile(workbook, fileName);\n};\n\n// Export to Excel - Separate Sheets Layout\nexport const exportSeparateSheetsExcel = (\n  eventTitle: string,\n  responses: any[],\n  components: any[],\n  config: ExcelExportConfig\n) => {\n  const workbook = XLSX.utils.book_new();\n  \n  responses.forEach((response, index) => {\n    const data: any[][] = [];\n    \n    // Add participant info\n    if (config.includeEventTitle) {\n      data.push([eventTitle]);\n    }\n    \n    if (config.includeParticipantName) {\n      data.push([`المشارك: ${response.participant?.name || \"مشارك مجهول\"}`]);\n    }\n    \n    if (config.includeParticipationDate) {\n      const date = response.completedAt || response.startedAt;\n      data.push([`التاريخ: ${date ? format(new Date(date), \"PPP\", { locale: ar }) : \"\"}`]);\n    }\n    \n    data.push([]); // Empty row\n    \n    // Add questions and answers\n    data.push([\"السؤال\", \"الإجابة\"]);\n    \n    const questionComponents = components.filter(\n      c => config.includeAllQuestions && (c.type === \"question\" || c.type === \"rating\")\n    );\n    \n    questionComponents.forEach(component => {\n      const label = component.settings?.label || \"سؤال\";\n      const answer = response.answers.find((a: any) => a.componentId === component.id);\n      data.push([label, formatAnswer(answer, component)]);\n    });\n    \n    // Create worksheet\n    const worksheet = XLSX.utils.aoa_to_sheet(data);\n    \n    // Set column widths\n    if (config.autoFitColumns) {\n      worksheet['!cols'] = [\n        { wch: 40 }, // Question column\n        { wch: 60 }  // Answer column\n      ];\n    }\n    \n    // Add worksheet\n    const sheetName = `مشارك ${index + 1}`;\n    XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);\n  });\n  \n  // Generate file and download\n  const fileName = `${eventTitle.replace(/\\s+/g, \"-\")}-results-${new Date().toISOString().split(\"T\")[0]}.xlsx`;\n  XLSX.writeFile(workbook, fileName);\n};\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3549, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/services/contactsService.ts"],"sourcesContent":["/**\n * Contacts Service - خدمة جهات الاتصال\n * الاتصال بـ Backend API لجهات الاتصال والمجموعات\n */\n\nimport { apiClient, ApiResponse } from \"../client\";\nimport {\n  BackendContactDto,\n  BackendGroupDto,\n  BackendPagedResult,\n  mapContact,\n  mapGroup,\n  mapContactFormToBackend,\n  mapGroupFormToBackend,\n} from \"../mappers\";\nimport { Contact, ContactFormData, Group, GroupFormData } from \"@/types/contact\";\n\n// ============================================================\n// خدمة جهات الاتصال\n// ============================================================\n\nexport const contactsService = {\n  /**\n   * جلب جميع جهات الاتصال (مع Pagination)\n   * Backend يُرجع PagedResult<ContactDto>\n   */\n  getAll: async (): Promise<Contact[]> => {\n    const response = await apiClient.get<ApiResponse<BackendPagedResult<BackendContactDto>>>(\"/Contacts\");\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل جلب جهات الاتصال\");\n    }\n\n    // استخراج الـ items من الاستجابة المُرقّمة\n    return response.data.data.items.map(mapContact);\n  },\n\n  /**\n   * جلب جهة اتصال بواسطة ID\n   */\n  getById: async (id: string): Promise<Contact> => {\n    const response = await apiClient.get<ApiResponse<BackendContactDto>>(\n      `/Contacts/${id}`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"جهة الاتصال غير موجودة\");\n    }\n\n    return mapContact(response.data.data);\n  },\n\n  /**\n   * إنشاء جهة اتصال جديدة\n   */\n  create: async (data: ContactFormData): Promise<Contact> => {\n    const response = await apiClient.post<ApiResponse<BackendContactDto>>(\n      \"/Contacts\",\n      mapContactFormToBackend(data)\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إنشاء جهة الاتصال\");\n    }\n\n    return mapContact(response.data.data);\n  },\n\n  /**\n   * تحديث جهة اتصال\n   */\n  update: async (id: string, data: Partial<ContactFormData>): Promise<Contact> => {\n    const response = await apiClient.put<ApiResponse<BackendContactDto>>(\n      `/Contacts/${id}`,\n      mapContactFormToBackend(data as ContactFormData)\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تحديث جهة الاتصال\");\n    }\n\n    return mapContact(response.data.data);\n  },\n\n  /**\n   * حذف جهة اتصال\n   */\n  delete: async (id: string): Promise<void> => {\n    const response = await apiClient.delete<ApiResponse<null>>(`/Contacts/${id}`);\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل حذف جهة الاتصال\");\n    }\n  },\n\n  /**\n   * البحث في جهات الاتصال\n   */\n  search: async (query: string): Promise<Contact[]> => {\n    const response = await apiClient.get<ApiResponse<BackendContactDto[]>>(\n      `/Contacts/search?query=${encodeURIComponent(query)}`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      return [];\n    }\n\n    return response.data.data.map(mapContact);\n  },\n};\n\n// ============================================================\n// خدمة المجموعات\n// ============================================================\n\nexport const groupsService = {\n  /**\n   * جلب جميع المجموعات\n   */\n  getAll: async (): Promise<Group[]> => {\n    const response = await apiClient.get<ApiResponse<BackendGroupDto[]>>(\"/Groups\");\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل جلب المجموعات\");\n    }\n\n    return response.data.data.map(mapGroup);\n  },\n\n  /**\n   * جلب مجموعة بواسطة ID\n   */\n  getById: async (id: string): Promise<Group> => {\n    const response = await apiClient.get<ApiResponse<BackendGroupDto>>(`/Groups/${id}`);\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"المجموعة غير موجودة\");\n    }\n\n    return mapGroup(response.data.data);\n  },\n\n  /**\n   * إنشاء مجموعة جديدة\n   */\n  create: async (data: GroupFormData): Promise<Group> => {\n    const response = await apiClient.post<ApiResponse<BackendGroupDto>>(\n      \"/Groups\",\n      mapGroupFormToBackend(data)\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إنشاء المجموعة\");\n    }\n\n    return mapGroup(response.data.data);\n  },\n\n  /**\n   * تحديث مجموعة\n   */\n  update: async (id: string, data: Partial<GroupFormData>): Promise<Group> => {\n    const response = await apiClient.put<ApiResponse<BackendGroupDto>>(\n      `/Groups/${id}`,\n      mapGroupFormToBackend(data as GroupFormData)\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تحديث المجموعة\");\n    }\n\n    return mapGroup(response.data.data);\n  },\n\n  /**\n   * حذف مجموعة\n   */\n  delete: async (id: string): Promise<void> => {\n    const response = await apiClient.delete<ApiResponse<null>>(`/Groups/${id}`);\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل حذف المجموعة\");\n    }\n  },\n\n  /**\n   * إضافة جهات اتصال إلى مجموعة\n   */\n  addContacts: async (groupId: string, contactIds: string[]): Promise<void> => {\n    const response = await apiClient.post<ApiResponse<null>>(\n      `/Groups/${groupId}/contacts`,\n      { contactIds }\n    );\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل إضافة جهات الاتصال\");\n    }\n  },\n\n  /**\n   * إزالة جهات اتصال من مجموعة\n   */\n  removeContacts: async (groupId: string, contactIds: string[]): Promise<void> => {\n    const response = await apiClient.delete<ApiResponse<null>>(\n      `/Groups/${groupId}/contacts`,\n      { data: { contactIds } }\n    );\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل إزالة جهات الاتصال\");\n    }\n  },\n};\n\nexport default { contactsService, groupsService };\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3700, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/services/responsesService.ts"],"sourcesContent":["/**\n * Responses Service - خدمة الردود\n * الاتصال بـ Backend API للردود\n */\n\nimport { apiClient, ApiResponse } from \"../client\";\nimport {\n  BackendResponseDto,\n  BackendPagedResult,\n  mapResponse,\n  mapResponseToBackendStart,\n  mapSectionAnswersToBackend,\n} from \"../mappers\";\nimport { Response, ComponentAnswer, ParticipantInfo } from \"@/types/response\";\n\n// ============================================================\n// أنواع الطلبات\n// ============================================================\n\ninterface StartResponseRequest {\n  respondentName?: string;\n  respondentEmail?: string;\n  respondentPhone?: string;\n}\n\ninterface SubmitSectionAnswersRequest {\n  sectionIndex: number;\n  answers: Array<{\n    componentId: string;\n    answerJson: string;\n  }>;\n}\n\ninterface CompleteResponseRequest {\n  finalAnswers?: Array<{\n    componentId: string;\n    answerJson: string;\n  }>;\n}\n\n// ============================================================\n// خدمة الردود\n// ============================================================\n\nexport const responsesService = {\n  /**\n   * بدء استجابة جديدة (للمشاركين - بدون مصادقة)\n   */\n  startResponse: async (eventId: string, participantInfo?: ParticipantInfo): Promise<Response> => {\n    const request: StartResponseRequest = {\n      respondentName: participantInfo?.name,\n      respondentEmail: participantInfo?.email,\n      respondentPhone: participantInfo?.phone,\n    };\n\n    const response = await apiClient.post<ApiResponse<BackendResponseDto>>(\n      `/Responses/event/${eventId}/start`,\n      request\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل بدء الاستجابة\");\n    }\n\n    return mapResponse(response.data.data);\n  },\n\n  /**\n   * إرسال إجابات قسم (للمشاركين - بدون مصادقة)\n   */\n  submitSectionAnswers: async (\n    responseId: string,\n    sectionIndex: number,\n    answers: ComponentAnswer[]\n  ): Promise<Response> => {\n    const request: SubmitSectionAnswersRequest = {\n      sectionIndex,\n      answers: mapSectionAnswersToBackend(answers),\n    };\n\n    const response = await apiClient.post<ApiResponse<BackendResponseDto>>(\n      `/Responses/${responseId}/section-answers`,\n      request\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إرسال الإجابات\");\n    }\n\n    return mapResponse(response.data.data);\n  },\n\n  /**\n   * إكمال الاستجابة (للمشاركين - بدون مصادقة)\n   */\n  completeResponse: async (\n    responseId: string,\n    finalAnswers?: ComponentAnswer[]\n  ): Promise<Response> => {\n    const request: CompleteResponseRequest = {\n      finalAnswers: finalAnswers ? mapSectionAnswersToBackend(finalAnswers) : undefined,\n    };\n\n    const response = await apiClient.post<ApiResponse<BackendResponseDto>>(\n      `/Responses/${responseId}/complete`,\n      request\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل إكمال الاستجابة\");\n    }\n\n    return mapResponse(response.data.data);\n  },\n\n  /**\n   * جلب ردود حدث معين (للمالك - يحتاج مصادقة)\n   */\n  getByEventId: async (eventId: string): Promise<Response[]> => {\n    const response = await apiClient.get<ApiResponse<BackendPagedResult<BackendResponseDto>>>(\n      `/Responses/event/${eventId}`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل جلب الردود\");\n    }\n\n    return response.data.data.items.map(mapResponse);\n  },\n\n  /**\n   * جلب رد بالـ ID (للمالك - يحتاج مصادقة)\n   */\n  getById: async (responseId: string): Promise<Response> => {\n    const response = await apiClient.get<ApiResponse<BackendResponseDto>>(\n      `/Responses/${responseId}`\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"الرد غير موجود\");\n    }\n\n    return mapResponse(response.data.data);\n  },\n\n  /**\n   * حذف رد (للمالك - يحتاج مصادقة)\n   */\n  delete: async (responseId: string): Promise<void> => {\n    const response = await apiClient.delete<ApiResponse<null>>(\n      `/Responses/${responseId}`\n    );\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل حذف الرد\");\n    }\n  },\n\n  /**\n   * البحث عن رد سابق للمشارك (للتعديل - بدون مصادقة)\n   */\n  getExistingResponse: async (eventId: string, email?: string): Promise<Response | null> => {\n    const params = email ? `?email=${encodeURIComponent(email)}` : \"\";\n    const response = await apiClient.get<ApiResponse<BackendResponseDto | null>>(\n      `/Responses/event/${eventId}/existing${params}`\n    );\n\n    if (!response.data.success) {\n      throw new Error(response.data.message || \"فشل البحث عن الرد السابق\");\n    }\n\n    // إذا لم يوجد رد سابق\n    if (!response.data.data) {\n      return null;\n    }\n\n    return mapResponse(response.data.data);\n  },\n\n  /**\n   * تحديث إجابات رد موجود (للتعديل - بدون مصادقة)\n   */\n  updateResponseAnswers: async (\n    responseId: string,\n    answers: ComponentAnswer[]\n  ): Promise<Response> => {\n    const request = {\n      answers: mapSectionAnswersToBackend(answers),\n    };\n\n    const response = await apiClient.put<ApiResponse<BackendResponseDto>>(\n      `/Responses/${responseId}/answers`,\n      request\n    );\n\n    if (!response.data.success || !response.data.data) {\n      throw new Error(response.data.message || \"فشل تحديث الإجابات\");\n    }\n\n    return mapResponse(response.data.data);\n  },\n};\n\nexport default responsesService;\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3814, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/services/filesService.ts"],"sourcesContent":["import { apiClient, ApiResponse } from \"../client\";\n\n// ===================================\n// File Upload Service\n// خدمة رفع الملفات\n// ===================================\n\nexport interface FileUploadResponse {\n  fileUrl: string;\n  fileName: string;\n  fileSize: number;\n  fileType: string;\n  uploadedAt: string;\n}\n\nexport type FileCategory = \"image\" | \"video\" | \"pdf\" | \"signature\";\n\nexport interface UploadProgressCallback {\n  (progress: number): void;\n}\n\n/**\n * رفع ملف إلى الخادم\n * @param file الملف المراد رفعه\n * @param type نوع الملف (image, video, pdf, signature)\n * @param onProgress callback لتتبع التقدم\n * @returns معلومات الملف المرفوع\n */\nexport async function uploadFile(\n  file: File,\n  type: FileCategory,\n  onProgress?: UploadProgressCallback\n): Promise<FileUploadResponse> {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n\n  // استخدام XMLHttpRequest للحصول على progress\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n\n    xhr.upload.addEventListener(\"progress\", (event) => {\n      if (event.lengthComputable && onProgress) {\n        const progress = Math.round((event.loaded / event.total) * 100);\n        onProgress(progress);\n      }\n    });\n\n    xhr.addEventListener(\"load\", () => {\n      if (xhr.status >= 200 && xhr.status < 300) {\n        try {\n          const response: ApiResponse<FileUploadResponse> = JSON.parse(\n            xhr.responseText\n          );\n          if (response.success && response.data) {\n            resolve(response.data);\n          } else {\n            reject(new Error(response.message || \"فشل رفع الملف\"));\n          }\n        } catch {\n          reject(new Error(\"خطأ في تحليل الاستجابة\"));\n        }\n      } else {\n        try {\n          const errorResponse = JSON.parse(xhr.responseText);\n          reject(new Error(errorResponse.message || `خطأ HTTP: ${xhr.status}`));\n        } catch {\n          reject(new Error(`خطأ HTTP: ${xhr.status}`));\n        }\n      }\n    });\n\n    xhr.addEventListener(\"error\", () => {\n      reject(new Error(\"فشل الاتصال بالخادم\"));\n    });\n\n    xhr.addEventListener(\"abort\", () => {\n      reject(new Error(\"تم إلغاء الرفع\"));\n    });\n\n    // فتح الاتصال\n    // NEXT_PUBLIC_API_URL يحتوي على /api بالفعل (مثل: http://localhost:5250/api)\n    const baseUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:5250/api\";\n    xhr.open(\"POST\", `${baseUrl}/Files/upload?type=${type}`);\n\n    // إضافة credentials إذا لزم الأمر\n    xhr.withCredentials = true;\n\n    xhr.send(formData);\n  });\n}\n\n/**\n * رفع ملف باستخدام fetch (بدون progress)\n * @param file الملف\n * @param type نوع الملف\n */\nexport async function uploadFileSimple(\n  file: File,\n  type: FileCategory\n): Promise<FileUploadResponse> {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n\n  const response = await apiClient.post<ApiResponse<FileUploadResponse>>(\n    `/Files/upload?type=${type}`,\n    formData,\n    {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\",\n      },\n    }\n  );\n\n  if (!response.data.success || !response.data.data) {\n    throw new Error(response.data.message || \"فشل رفع الملف\");\n  }\n\n  return response.data.data;\n}\n\n/**\n * تحويل Base64 إلى File\n * مفيد للتوقيعات\n */\nexport function base64ToFile(\n  base64: string,\n  fileName: string,\n  mimeType: string\n): File {\n  const byteString = atob(base64.split(\",\")[1]);\n  const ab = new ArrayBuffer(byteString.length);\n  const ia = new Uint8Array(ab);\n\n  for (let i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n\n  return new File([ab], fileName, { type: mimeType });\n}\n\n/**\n * الحصول على URL الكامل للملف\n * الملفات الثابتة تُخدم من الجذر وليس من /api\n */\nexport function getFullFileUrl(fileUrl: string): string {\n  if (!fileUrl) return \"\";\n  if (fileUrl.startsWith(\"http\") || fileUrl.startsWith(\"data:\")) {\n    return fileUrl;\n  }\n  // إزالة /api من المسار لأن الملفات الثابتة تُخدم من الجذر\n  let baseUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:5250\";\n  // إذا كان baseUrl ينتهي بـ /api، نزيله\n  if (baseUrl.endsWith(\"/api\")) {\n    baseUrl = baseUrl.slice(0, -4);\n  }\n  return `${baseUrl}${fileUrl}`;\n}\n\n// Export service object\nexport const filesService = {\n  uploadFile,\n  uploadFileSimple,\n  base64ToFile,\n  getFullFileUrl,\n};\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3929, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/frontend2/event-meena/lib/api/services/index.ts"],"sourcesContent":["/**\n * API Services - تصدير جميع الخدمات\n */\n\nexport { authService } from \"./authService\";\nexport { contactsService, groupsService } from \"./contactsService\";\nexport { eventsService } from \"./eventsService\";\nexport { responsesService } from \"./responsesService\";\nexport { filesService } from \"./filesService\";\nexport type { FileUploadResponse, FileCategory } from \"./filesService\";\n"],"names":[],"mappings":"AAAA;;CAEC;AAED;AACA;AACA;AACA;AACA","debugId":null}}]
}