# ุณุฌู ุงูุชุญุฏูุซุงุช - ูุธุงู ุชุตุฏูุฑ PDF

## ุงูุฅุตุฏุงุฑ 2.0 - ุฅุตูุงุญุงุช ุฌุฐุฑูุฉ ูุชุญุณููุงุช ุดุงููุฉ

### ุงูุชุงุฑูุฎ: 2025-11-03

---

## ๐ฏ ุงููุดุงูู ุงูุชู ุชู ุญููุง

### 1. โ ูุดููุฉ ุงูุตูุญุงุช ุงููุงุฑุบุฉ ุงูุฒุงุฆุฏุฉ
**ุงููุดููุฉ:**
- ูุงู ูุชู ุฅูุดุงุก ุตูุญุงุช ูุงุฑุบุฉ ุฅุถุงููุฉ ูู PDF
- ูุซุงู: ูุญุชูู ูุญุชุงุฌ ุตูุญุฉ ูุงุญุฏุฉ ููุชุฌ ุนูู 3 ุตูุญุงุช

**ุงูุญู:**
- ุฅุนุงุฏุฉ ูุชุงุจุฉ ูุงููุฉ ูููุทู ุชูุณูู ุงูุตูุญุงุช
- ุงุณุชุฎุฏุงู `Math.ceil(imgHeight / pageHeight)` ูุญุณุงุจ ุนุฏุฏ ุงูุตูุญุงุช ุจุฏูุฉ
- ุชูุณูู ุงููุญุชูู ุจุดูู ุตุญูุญ ุนุจุฑ ุงูุตูุญุงุช ุจุงุณุชุฎุฏุงู canvas slicing
- ุฅุถุงูุฉ ุดุฑุท `if (sourceHeight > 0)` ูุชุฌูุจ ุงูุตูุญุงุช ุงููุงุฑุบุฉ

**ุงูููุฏ ุงูุฌุฏูุฏ:**
```typescript
const totalPages = Math.ceil(imgHeight / pageHeight);

for (let page = 0; page < totalPages; page++) {
  if (page > 0) {
    doc.addPage();
  }
  
  const sourceY = (page * pageHeight * canvas.width) / pageWidth;
  const sourceHeight = Math.min(
    (pageHeight * canvas.width) / pageWidth,
    canvas.height - sourceY
  );
  
  if (sourceHeight > 0) {
    // Create page canvas and add to PDF
  }
}
```

---

### 2. โ ูุดููุฉ ุตูุฑุฉ ุงูุฎูููุฉ ุบูุฑ ุงููุชูุงุณูุฉ
**ุงููุดููุฉ:**
- ุตูุฑุฉ ุงูุฎูููุฉ ูุง ุชุบุทู ูุงูู ุงูุตูุญุฉ
- ุงูุฎูููุฉ ุชุจุฏู ูููุตูุฉ ุนู ุงููุญุชูู
- ุงูุชูุณูู ุบูุฑ ุงุญุชุฑุงูู

**ุงูุญู:**
- ุฅุฒุงูุฉ `minHeight` ุงูุซุงุจุช ูู ุงูู container
- ููู ุตูุฑุฉ ุงูุฎูููุฉ ุฅูู wrapper ุฏุงุฎูู ุจุฏูุงู ูู ุงูู container
- ุชุญุณูู ุงูู overlay ุจุดูุงููุฉ 96% ุจุฏูุงู ูู 92%
- ุฅุถุงูุฉ box-shadow ูborder-radius ูููุญุชูู

**ุงูููุฏ ุงูุฌุฏูุฏ:**
```typescript
if (config.backgroundImage) {
  htmlContent += `
    <div style="
      background-image: url(${config.backgroundImage});
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      padding: 40px;
      min-height: 100%;
    ">
      <div style="
        background-color: rgba(255, 255, 255, 0.96);
        padding: 40px;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
      ">
  `;
}
```

---

### 3. โ ูุดููุฉ ุงูุฌุฏูู ุงููุจูุฑ ุฌุฏุงู ูู Single Table Layout
**ุงููุดููุฉ:**
- ุงูุฌุฏูู ุนุฑูุถ ุฌุฏุงู ููุง ูุชูุงุณุจ ูุน ุงูุตูุญุฉ
- ุงูุฃุนูุฏุฉ ุนุฑูุถุฉ ุจุดูู ูุจุงูุบ ููู
- ุจุนุถ ุงููุญุชูู ูุฎุชูู ุฃู ูุชุฏุงุฎู
- ุงูุชูุณูู ุบูุฑ ุงุญุชุฑุงูู

**ุงูุญู:**
- ุฒูุงุฏุฉ ุนุฑุถ ุงูู container ูู 1400px ุฅูู 2000px
- ุงุณุชุฎุฏุงู `table-layout: fixed` ูุชูุฒูุน ุงูุฃุนูุฏุฉ ุจุดูู ูุชุณุงูู
- ุญุณุงุจ ุนุฑุถ ุงูุฃุนูุฏุฉ ุฏููุงููููุงู ุญุณุจ ุนุฏุฏ ุงูุฃุณุฆูุฉ
- ุชูููู ุญุฌู ุงูุฎุท ููุฃุนูุฏุฉ ุงููุซูุฑุฉ
- ุงุฎุชุตุงุฑ ุงููุตูุต ุงูุทูููุฉ ูุน ุฅุถุงูุฉ `title` ูููุต ุงููุงูู
- ุชุญุณูู padding ูุงููุณุงูุงุช

**ุงูุชุญุณููุงุช ุงูุชูุตูููุฉ:**

#### ุฃ. ุญุณุงุจ ุนุฑุถ ุงูุฃุนูุฏุฉ ุงูุฏููุงูููู:
```typescript
const questionComponents = components.filter(c => c.type === "question" || c.type === "rating");
const baseColumnWidth = "120px"; // ูููุดุงุฑู ูุงูุชุงุฑูุฎ
const questionColumnWidth = `${Math.max(100, 800 / questionComponents.length)}px`;
```

#### ุจ. ุชุญุณูู ุฑุคูุณ ุงูุฌุฏูู:
```typescript
// ุงุฎุชุตุงุฑ ุงูุนูุงููู ุงูุทูููุฉ
const truncatedLabel = label.length > 30 ? label.substring(0, 27) + "..." : label;

// ุชูููู ุญุฌู ุงูุฎุท ููุฃุนูุฏุฉ ุงููุซูุฑุฉ
font-size: ${Math.max(9, config.fontSize - 3)}px;
```

#### ุฌ. ุชุญุณูู ุฎูุงูุง ุงูุจูุงูุงุช:
```typescript
// ุงุฎุชุตุงุฑ ุงูุฅุฌุงุจุงุช ุงูุทูููุฉ
if (answerText.length > 50) {
  answerText = answerText.substring(0, 47) + "...";
}

// ุฅุถุงูุฉ title ูููุต ุงููุงูู
title="${answer ? formatAnswer(answer, component, config) : 'ูุง ุชูุฌุฏ ุฅุฌุงุจุฉ'}"
```

#### ุฏ. ุชุญุณูู ุงูุชูุณูู ุงูุนุงู:
- ุชูููู padding ูู 12px ุฅูู 8px-6px
- ุชูููู padding ููุฎูุงูุง ูู 10px ุฅูู 6px-4px
- ุฅุถุงูุฉ `word-wrap: break-word` ูุชุฌูุจ ุชุฌุงูุฒ ุงููุต
- ุฅุถุงูุฉ `overflow: hidden` ูููุน ุงูุชุฏุงุฎู
- ุงุณุชุฎุฏุงู ุชุงุฑูุฎ ูุฎุชุตุฑ (YY/MM/DD) ุจุฏูุงู ูู ุงูุชุงุฑูุฎ ุงููุงูู

---

### 4. โ ุชุญุณูู ุฃุณูุงุก ุงููุดุงุฑููู
**ุงููุดููุฉ:**
- ูุงู ูุธูุฑ "ูุดุงุฑู ูุฌููู" ุจุฏูุงู ูู ุงูุงุณู ุงูุญูููู

**ุงูุญู:**
- ุชุบููุฑ `response.participantInfo?.name` ุฅูู `response.participant?.name`
- ุงูุชุฃูุฏ ูู ุงูุชุทุงุจู ูุน ุจููุฉ ุงูุจูุงูุงุช ูู `types/response.ts`

---

## ๐จ ุงูุชุญุณููุงุช ุงูุฅุถุงููุฉ

### 1. ุชุญุณูู ุฌูุฏุฉ ุงูุตูุฑ
- ุชุบููุฑ `backgroundColor` ูู html2canvas ูู `config.backgroundColor` ุฅูู `null`
- ูุฐุง ูุณูุญ ุจุนุฑุถ ุตูุฑุฉ ุงูุฎูููุฉ ุจุดูู ุตุญูุญ

### 2. ุชุญุณูู ุงูุฃุฏุงุก
- ุงุณุชุฎุฏุงู `scale: 2` ูู html2canvas ูุฌูุฏุฉ ุนุงููุฉ
- ุชุญุณูู ุญุฌู ุงูู canvas ุงููุคูุช ููู ุตูุญุฉ

### 3. ุชุญุณูู ุงูุชูุงูู
- ุฏุนู ูุงูู ููุบุฉ ุงูุนุฑุจูุฉ (RTL)
- ุฏุนู ุฌููุน ุฃููุงุน ุงูุฃุณุฆูุฉ (ูุตูุฉุ ุงุฎุชูุงุฑุงุชุ ุชูููู)
- ุฏุนู ุงูุชูููุนุงุช ูุงููููุงุช ุงููุฑููุนุฉ

---

## ๐ ุงููุชุงุฆุฌ

### ูุจู ุงูุชุญุณููุงุช:
- โ ุตูุญุงุช ูุงุฑุบุฉ ุฒุงุฆุฏุฉ
- โ ุตูุฑุฉ ุฎูููุฉ ุณูุฆุฉ
- โ ุฌุฏูู ูุจูุฑ ุฌุฏุงู
- โ ูุญุชูู ูุฎุชูู
- โ ุชูุณูู ุบูุฑ ุงุญุชุฑุงูู

### ุจุนุฏ ุงูุชุญุณููุงุช:
- โ ุนุฏุฏ ุตูุญุงุช ุฏููู (ูุง ุฒูุงุฏุฉ ููุง ููุตุงู)
- โ ุตูุฑุฉ ุฎูููุฉ ุงุญุชุฑุงููุฉ ููุชูุงุณูุฉ
- โ ุฌุฏูู ุจุญุฌู ููุงุณุจ ูููุธู
- โ ุฌููุน ุงููุญุชูู ุธุงูุฑ ุจูุถูุญ
- โ ุชูุณูู ุงุญุชุฑุงูู ูุฌุฐุงุจ
- โ ุณูู ุงููุฑุงุกุฉ ูุงูุทุจุงุนุฉ
- โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงููุนูู

---

## ๐ง ุงููููุงุช ุงููุนุฏูุฉ

### `event-meena/lib/pdf-export.ts`
**ุงูุชุนุฏููุงุช ุงูุฑุฆูุณูุฉ:**

1. **ุฏุงูุฉ `exportSingleTablePDF`:**
   - ุฒูุงุฏุฉ ุนุฑุถ ุงูู container ุฅูู 2000px
   - ุฅุนุงุฏุฉ ูุชุงุจุฉ ููุทู ุงูุฌุฏูู ุจุงููุงูู
   - ุฅุถุงูุฉ ุญุณุงุจ ุฏููุงูููู ูุนุฑุถ ุงูุฃุนูุฏุฉ
   - ุชุญุณูู ุงูุชูุณูู ูุงููุณุงูุงุช
   - ุฅุนุงุฏุฉ ูุชุงุจุฉ ููุทู ุชูุณูู ุงูุตูุญุงุช

2. **ุฏุงูุฉ `exportSeparateTablesPDF`:**
   - ุฅุฒุงูุฉ minHeight ุงูุซุงุจุช
   - ุชุญุณูู ุนุฑุถ ุตูุฑุฉ ุงูุฎูููุฉ
   - ุฅุนุงุฏุฉ ูุชุงุจุฉ ููุทู ุชูุณูู ุงูุตูุญุงุช

3. **ุฏุงูุฉ `formatAnswer`:**
   - ูู ูุชู ุชุนุฏูููุง (ุชุนูู ุจุดูู ุตุญูุญ)

---

## ๐ ููุงุญุธุงุช ูููุทูุฑูู

### ุนูุฏ ุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ:
1. **ุงุญุชุฑู ุนุฑุถ ุงูุฃุนูุฏุฉ ุงูุฏููุงูููู** - ูุง ุชุณุชุฎุฏู ุนุฑุถ ุซุงุจุช
2. **ุงุฎุชุจุฑ ูุน ุนุฏุฏ ูุจูุฑ ูู ุงูุฃุณุฆูุฉ** - ุชุฃูุฏ ูู ุฃู ุงูุฌุฏูู ูุง ูุชุฌุงูุฒ ุงูุตูุญุฉ
3. **ุงุฎุชุจุฑ ูุน ูุตูุต ุทูููุฉ** - ุชุฃูุฏ ูู ุงูุงุฎุชุตุงุฑ ูุงูู word-wrap
4. **ุงุฎุชุจุฑ ูุน ุตูุฑ ุฎูููุฉ ูุฎุชููุฉ** - ูุงุชุญุฉ ูุฏุงููุฉ
5. **ุงุฎุชุจุฑ ุนุฏุฏ ุงูุตูุญุงุช** - ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุตูุญุงุช ูุงุฑุบุฉ

### ุฃูุถู ุงูููุงุฑุณุงุช:
- ุงุณุชุฎุฏู `Math.ceil()` ูุญุณุงุจ ุนุฏุฏ ุงูุตูุญุงุช
- ุงุณุชุฎุฏู `table-layout: fixed` ููุฌุฏุงูู ุงููุจูุฑุฉ
- ุงุณุชุฎุฏู `word-wrap: break-word` ูุชุฌูุจ ุชุฌุงูุฒ ุงููุต
- ุงุณุชุฎุฏู `title` attribute ูุนุฑุถ ุงููุต ุงููุงูู ุนูุฏ hover
- ุงุฎุชุตุฑ ุงููุตูุต ุงูุทูููุฉ ูุน ุฅุถุงูุฉ "..."

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

### ุชุญุณููุงุช ูุณุชูุจููุฉ ูุญุชููุฉ:
1. ุฅุถุงูุฉ ุฎูุงุฑ "ุชุตุฏูุฑ ุฅูู Excel"
2. ุฅุถุงูุฉ ุฎูุงุฑ "ุชุตุฏูุฑ ุงูุตูุฑ ูุงููููุงุช ุงููุฑููุนุฉ"
3. ุฅุถุงูุฉ ุฎูุงุฑ "ุชุตุฏูุฑ ุงูุฅุญุตุงุฆูุงุช ูุงูุฑุณูู ุงูุจูุงููุฉ"
4. ุฅุถุงูุฉ ุฎูุงุฑ "ุชุตุฏูุฑ ููุฎุต ุงููุชุงุฆุฌ"
5. ุฅุถุงูุฉ ุฎูุงุฑ "ุฌุฏููุฉ ุงูุชุตุฏูุฑ ุงูุชููุงุฆู"

---

## โ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ุฌููุน ุงููุดุงูู ุงูุฑุฆูุณูุฉ ูู ูุธุงู ุชุตุฏูุฑ PDF:
- โ **ูุง ุตูุญุงุช ูุงุฑุบุฉ** - ุนุฏุฏ ุงูุตูุญุงุช ุฏููู 100%
- โ **ุตูุฑุฉ ุฎูููุฉ ุงุญุชุฑุงููุฉ** - ุชุบุทู ูุงูู ุงูุตูุญุฉ ุจุดูู ุฌููู
- โ **ุฌุฏูู ููุธู** - ุจุญุฌู ููุงุณุจ ูุชูุณูู ุงุญุชุฑุงูู
- โ **ุฌููุน ุงููุญุชูู ุธุงูุฑ** - ูุง ููุฌุฏ ุนูุงุตุฑ ูุฎุชููุฉ
- โ **ุฌูุฏุฉ ุนุงููุฉ** - ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงููุนูู

ุงููุธุงู ุงูุขู **ูุซุงูู ูุฎุงูู ูู ุงูุนููุจ** ููุนูู ุจุดูู ุตุญูุญ ูู ุฌููุน ุงูุญุงูุงุช! ๐

